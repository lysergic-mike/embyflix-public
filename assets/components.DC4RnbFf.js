import{d as e,r as a,o as t,a as l,c as i,n as s,b as n,F as o,e as r,f as u,w as c,u as d,g as v,t as m,h as p,i as f,j as g,v as b,k as y,l as h,m as k,p as w,q as I,s as E,x as C,y as S,T as _,z as x,A as D,B as L}from"./vue-vendor.C6XCEWs1.js";import{u as P,a as T,b as A,d as M,i as N,T as U,c as R,e as O,f as F,g as $,h as q}from"./composables.C_I0WkG_.js";const B=""+new URL("EmbyFlix-logo.CCoAMb74.png",import.meta.url).href,W=440,G={MEDIA_CARD_SMALL:220,MEDIA_CARD_DEFAULT:300,MEDIA_CARD_LARGE:W,EPISODE_CARD:500,HERO_SLIDER:1920,BACKDROP_DEFAULT:1280,SIDEBAR_THUMB:154,DETAILS_POSTER:W},H={class:"sidebar w-[300px] transition-[width] duration-800"},V={class:"sidebar-nav","data-nav-container":"sidebar"},z=["onClick"],K={class:"nav-text"},Y={class:"opacity-0 transition-opacity duration-300 group-focus-within:opacity-50 group-hover:opacity-50 focus-within:!opacity-100 hover:!opacity-100"},j={key:0,class:"continue-watching-container mt-8 mb-25"},X={class:"continue-watching-list",style:{"list-style":"none"}},Q=["onClick"],Z={class:"absolute inset-0 overflow-hidden z-0 rounded-xl"},J=["src","alt"],ee={class:"flex flex-col justify-between z-1 relative h-40 w-full self-end px-4 pb-1 bg-gradient-to-t from-black/30 to-transparent group-focus/item:from-black/0"},ae={class:"item-title-wrapper"},te={class:"item-title font-bold text-white text-shadow"},le={key:0,class:"bg-black bg-opacity-30"},ie={class:"bottom-row w-full"},se={class:"progress-details flex justify-between w-full items-center"},ne={class:"flex bg-gray-600 bg-opacity-50 backdrop-blur-sm text-white px-2 rounded h-8 items-center justify-between gap-2"},oe={key:0},re=(e,a)=>{const t=e.__vccOpts||e;for(const[l,i]of a)t[l]=i;return t},ue=re(e({__name:"Sidebar",props:{activeNavItem:{},userName:{}},emits:["navigate","logout"],setup(e,{emit:f}){const g=f,b=d(),y=T(),h=P(),k=A(),w=a([]),I=[{id:"home",icon:"fas fa-home",text:"Home"},{id:"movies",icon:"fas fa-film",text:"Movies"},{id:"tvshows",icon:"fas fa-tv",text:"TV Shows"},{id:"collections",icon:"fas fa-folder",text:"Collections"},{id:"search",icon:"fas fa-search",text:"Search"},{id:"settings",icon:"fas fa-cog",text:"Settings"}],E=()=>{g("logout")},C=async()=>{if(y.isDemoMode.value)w.value=h.getContinueWatching();else try{const e=await k.getContinueWatching(),a=e.reduce((e,a)=>{const t=a.SeriesName||a.Name,l=a.ProductionYear;return e.some(e=>{const a=e.SeriesName||e.Name,i=e.ProductionYear;return a===t&&i===l})||e.push(a),e},[]);w.value=a,a.length,e.length}catch(e){console.error("[Sidebar] Failed to load continue watching:",e)}},S=e=>y.isDemoMode.value?e.ImageUrl||"":k.getImageUrl(e.Id,"Primary",G.MEDIA_CARD_DEFAULT),_=e=>e.UserData?.PlaybackPositionTicks&&e.RunTimeTicks?Math.round(e.UserData.PlaybackPositionTicks/e.RunTimeTicks*100):0,x=e=>"Episode"===e.Type&&e.ParentIndexNumber&&e.IndexNumber?`S${e.ParentIndexNumber} E${e.IndexNumber}`:"",D=()=>{C()},L=e=>{M(e);const a=document.activeElement;if(a?.closest(".sidebar")){if(N(e,U.MENU)){e.preventDefault();const a=document.querySelector(".sidebar .nav-item");return void(a&&a.focus())}if(e.keyCode>=49&&e.keyCode<=54){e.preventDefault();const a=e.keyCode-49;if(a<I.length){const e=I[a];b.push({name:e.text})}return}return N(e,U.SEARCH)||N(e,U.COLOR_YELLOW)?(e.preventDefault(),void b.push({name:"Search"})):N(e,U.COLOR_BLUE)||N(e,U.TOOLS)||N(e,U.INFO)?(e.preventDefault(),void b.push({name:"Settings"})):void 0}},R=a(!1);return t(()=>{C(),window.addEventListener("refresh-continue-watching",D),document.addEventListener("keydown",L),setTimeout(()=>{R.value=!0},50)}),l(()=>{window.removeEventListener("refresh-continue-watching",D),document.removeEventListener("keydown",L)}),(a,t)=>(v(),i("div",{class:s(["group sidebar-wrapper",{"enable-transition":R.value}]),"data-nav-zone":"sidebar"},[n("div",H,[n("nav",V,[(v(),i(o,null,r(I,a=>n("a",{key:a.id,href:"#",class:s(["nav-item",{active:e.activeNavItem===a.id}]),onClick:c(e=>g("navigate",a.id),["prevent"])},[n("i",{class:s(a.icon+" nav-icon")},null,2),n("span",K,m(a.text),1)],10,z)),64)),n("div",Y,[w.value.length>0?(v(),i("div",j,[t[1]||(t[1]=n("h3",{class:"pl-2 mb-3 text-white font-semibold"},"Continue Watching",-1)),n("ul",X,[(v(!0),i(o,null,r(w.value,e=>(v(),i("li",{key:e.Id,class:"continue-watching-item relative overflow-hidden mb-3"},[n("div",{class:"item-wrapper bg-black min-h-45 rounded-xl relative flex cursor-pointer group/item",onClick:a=>(e=>{b.push({name:"Player",params:{itemId:e.Id}})})(e),tabindex:"0"},[n("div",Z,[n("img",{class:"w-full h-full object-cover",src:S(e),alt:e.SeriesName||e.Name,loading:"lazy",decoding:"async"},null,8,J)]),n("div",ee,[n("div",ae,[n("span",te,m(e.SeriesName||e.Name),1),_(e)?(v(),i("div",le,[n("div",{class:"progress-bar bg-[#13ff00] h-1 mt-2 shadow-sm rounded-sm",style:p({width:_(e)+"%"})},null,4)])):u("",!0)]),n("div",ie,[n("div",se,[t[0]||(t[0]=n("span",{class:"btn-overlay bg-gray-600 bg-opacity-50 backdrop-blur-sm rounded-full w-8 h-8 flex justify-center items-center text-white"},[n("i",{class:"fas fa-play"})],-1)),n("div",ne,[x(e)?(v(),i("span",oe,m(x(e)),1)):u("",!0),n("span",null,m(_(e))+"%",1)])])])])],8,Q)]))),128))])])):u("",!0)]),n("a",{href:"#",class:"nav-item logout-item",onClick:c(E,["prevent"])},[...t[2]||(t[2]=[n("i",{class:"fas fa-sign-out-alt nav-icon"},null,-1),n("span",{class:"nav-text"},"Logout",-1)])])])])],2))}}),[["__scopeId","data-v-fa581bfb"]]),ce={class:"search-container flex-1 flex items-center justify-end px-8"},de={class:"search-wrapper relative w-full max-w-125"},ve=re(e({__name:"Header",setup(e){const t=d(),l=y(),o=a(""),r=a(!1);f(()=>l.query.q,e=>{"Search"===l.name&&(o.value=e||"")},{immediate:!0}),f(o,e=>{"Search"===l.name&&e.trim()&&t.replace({name:"Search",query:{q:e.trim()}})});const u=e=>{"Enter"===e.key&&o.value.trim()&&t.push({name:"Search",query:{q:o.value.trim()}})},c=()=>{t.push({name:"Search"})};return(e,a)=>(v(),i("div",ce,[n("div",de,[n("i",{class:"fas fa-search search-icon absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer",onClick:c}),g(n("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),type:"text",placeholder:"Movies, series, shows...",class:s(["search-input w-full h-12 pl-12 pr-12 rounded-lg bg-gray-800/80 text-white border-none transition-all",{"bg-gray-700/90":r.value}]),onFocus:a[1]||(a[1]=e=>r.value=!0),onBlur:a[2]||(a[2]=e=>r.value=!1),onKeydown:u,onClick:c,tabindex:"0"},null,34),[[b,o.value]])])]))}}),[["__scopeId","data-v-b282c8dc"]]),me={class:"layout"},pe={key:0,class:"global-backdrop"},fe=["src"],ge={class:"header"},be={class:"content"},ye={class:"main-content px-7.5"},he=re(e({__name:"BaseLayout",props:{activeNavItem:{},userName:{}},emits:["navigate","logout","search"],setup(e,{emit:s}){const o=s,r=a(""),c=e=>{o("search",e)},d=e=>{const a=e;r.value=a.detail||""};return t(()=>{const e=document.querySelector(".sidebar .nav-item");e&&e.focus(),window.addEventListener("update-backdrop",d)}),l(()=>{window.removeEventListener("update-backdrop",d)}),(a,t)=>(v(),i("div",me,[r.value?(v(),i("div",pe,[n("img",{src:r.value,alt:"Backdrop",class:"backdrop-image"},null,8,fe),t[2]||(t[2]=n("div",{class:"backdrop-gradient"},null,-1))])):u("",!0),n("div",ge,[t[3]||(t[3]=n("div",{class:"logo-container w-75 h-full flex items-center b-bottom-1 border-primary-color border-1 pl-5"},[n("img",{src:B,alt:"EmbyFlix",class:"header-logo"})],-1)),h(ve,{onSearch:c})]),n("div",be,[h(ue,{"active-nav-item":e.activeNavItem,"user-name":e.userName,onNavigate:t[0]||(t[0]=e=>o("navigate",e)),onLogout:t[1]||(t[1]=e=>o("logout"))},null,8,["active-nav-item","user-name"]),n("div",ye,[k(a.$slots,"default",{},void 0)])])]))}}),[["__scopeId","data-v-54501bb7"]]),ke={key:0,class:"layout-wrapper"},we={key:1,class:"no-layout-wrapper"},Ie=re(e({__name:"LayoutWrapper",setup(e){const t=y(),l=d(),s=T(),n=a("home"),o=w(()=>t.meta.layout||"none"),r=w(()=>"base"===o.value);f(()=>t.name,e=>{switch(e){case"Home":default:n.value="home";break;case"Search":n.value="search";break;case"Details":n.value="details"}},{immediate:!0});const u=e=>{switch(n.value=e,e){case"home":l.push({name:"Home"});break;case"search":l.push({name:"Search"});break;case"movies":case"tvshows":case"collections":case"settings":l.push({name:"Home"});const a=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(a);break;default:const t=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(t)}},c=()=>{s.logout(),l.push({name:"Login"})},m=e=>{const a=new CustomEvent("app-search",{detail:e});window.dispatchEvent(a)};return(e,a)=>{const t=C("RouterView");return r.value?(v(),i("div",ke,[h(he,{"active-nav-item":n.value,"user-name":I(s).currentUser.value?.Name||"User",onNavigate:u,onLogout:c,onSearch:m},{default:E(()=>[h(t)]),_:1},8,["active-nav-item","user-name"])])):(v(),i("div",we,[h(t)]))}}}),[["__scopeId","data-v-52626496"]]),Ee={class:"login-container"},Ce={key:0,class:"error-message"},Se={class:"form-group"},_e=["disabled"],xe={class:"form-group"},De=["disabled"],Le={class:"form-group"},Pe=["disabled"],Te=["disabled"],Ae=["disabled"],Me=e({__name:"LoginForm",props:{isLoading:{type:Boolean},error:{}},setup(e){const t=d(),l=T(),o=A(),r=a("http://localhost:8096"),c=a(""),p=a(""),f=a(""),y=async e=>{if(e&&e.preventDefault(),r.value&&c.value)try{const e=await o.authenticateByName(r.value,c.value,p.value);l.login(e.User),t.push({name:"Home"})}catch(a){f.value=a,console.error("Login failed:",a)}},h=()=>{l.enableDemoMode(),t.push({name:"Home"})};return(a,t)=>(v(),i("div",Ee,[n("div",{class:s(["login-box",{"bg-red":f.value}])},[t[6]||(t[6]=n("div",{class:"logo-wrapper"},[n("img",{src:B,alt:"EmbyFlix",class:"login-logo"})],-1)),t[7]||(t[7]=n("p",null,"Connect to your Emby Server",-1)),f.value?(v(),i("div",Ce,m(f.value),1)):u("",!0),n("form",{onSubmit:y},[n("div",Se,[t[3]||(t[3]=n("label",{for:"server-url"},"Server URL",-1)),g(n("input",{id:"server-url","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"https://your-server:8096",disabled:e.isLoading},null,8,_e),[[b,r.value]])]),n("div",xe,[t[4]||(t[4]=n("label",{for:"username"},"Username",-1)),g(n("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),type:"text",placeholder:"Enter username",disabled:e.isLoading},null,8,De),[[b,c.value]])]),n("div",Le,[t[5]||(t[5]=n("label",{for:"password"},"Password",-1)),g(n("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),type:"password",placeholder:"Enter password",disabled:e.isLoading},null,8,Pe),[[b,p.value]])]),n("button",{type:"submit",class:"btn-primary",disabled:e.isLoading||!r.value||!c.value||!p.value||p.value.length<8},m(e.isLoading?"Connecting...":"Connect to Server"),9,Te),n("button",{type:"button",class:"btn-secondary",disabled:e.isLoading,onClick:h}," Demo Mode (Test UI) ",8,Ae)],32)],2)]))}}),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"})),Ue={class:"hero-slider-container"},Re={key:0,class:"slider-section-title"},Oe=["data-slider-id"],Fe={class:"hero-slider"},$e=["src","alt"],qe=["src","alt"],Be={class:"slide-meta"},We={key:0,class:"meta-item"},Ge={key:1,class:"meta-item rating"},He={key:2,class:"meta-item"},Ve={key:3,class:"meta-item"},ze={key:2,class:"slide-genres"},Ke={key:3,class:"slide-description"},Ye={class:"slide-actions"},je={class:"slider-indicators"},Xe=["onClick","aria-label"],Qe=re(e({__name:"HeroSlider",props:{items:{},getImageUrl:{},title:{},showFavoriteButton:{type:Boolean,default:!0},height:{default:"600px"},titleSize:{default:"3rem"},sliderId:{default:"hero"}},emits:["play","favorite","navigate"],setup(e,{emit:c}){const d=e,g=A(),b=P(),y=T(),k=R(g,b,y.isDemoMode),C=c,x=a(),D=a(0),L=a("slider"),F=a("slider"),$=a(new Map),q=a(new Map),B=a(new Set),W=()=>{D.value=(D.value+1)%d.items.length},G=()=>{D.value=(D.value-1+d.items.length)%d.items.length},H=e=>{e>=0&&e<d.items.length&&(D.value=e,L.value="slider")},V=e=>{if(x.value===document.activeElement){if(M(e),N(e,U.CHANNEL_UP))return e.preventDefault(),e.stopPropagation(),void W();if(N(e,U.CHANNEL_DOWN))return e.preventDefault(),e.stopPropagation(),void G();if(N(e,U.MEDIA_PLAY)||N(e,U.MEDIA_PLAY_PAUSE))return e.preventDefault(),e.stopPropagation(),void X(d.items[D.value]);if(N(e,U.MEDIA_RECORD))return e.preventDefault(),e.stopPropagation(),void Q(d.items[D.value]);if(N(e,U.INFO))return e.preventDefault(),e.stopPropagation(),void Z(d.items[D.value]);if(N(e,U.COLOR_RED))return e.preventDefault(),e.stopPropagation(),void X(d.items[D.value]);if(N(e,U.COLOR_GREEN))return e.preventDefault(),e.stopPropagation(),void Q(d.items[D.value]);if(e.keyCode>=48&&e.keyCode<=57){const a=48===e.keyCode?9:e.keyCode-49;return void(a<d.items.length&&(e.preventDefault(),e.stopPropagation(),H(a)))}}},z=e=>{if(x.value===document.activeElement)switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),"slider"===L.value?Z(d.items[D.value]):"play"===L.value?X(d.items[D.value]):"favorite"===L.value&&Q(d.items[D.value]);break;case"ArrowLeft":if(e.preventDefault(),e.stopPropagation(),"slider"===L.value)if(0===D.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"left"});window.dispatchEvent(e)}else G();else"play"===L.value?L.value="slider":"favorite"===L.value&&(L.value="play");break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),"slider"===L.value?W():"play"===L.value?d.showFavoriteButton?L.value="favorite":(W(),L.value="slider"):"favorite"===L.value&&(W(),L.value="slider");break;case"ArrowDown":if(e.preventDefault(),e.stopPropagation(),"slider"===L.value)L.value="play";else if("play"===L.value||"favorite"===L.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"down"});window.dispatchEvent(e)}break;case"ArrowUp":if(e.preventDefault(),e.stopPropagation(),"slider"===L.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"up"});window.dispatchEvent(e)}else("play"===L.value||"favorite"===L.value)&&(L.value="slider")}},K=e=>{const a=e.relatedTarget;(!a||!x.value?.contains(a))&&(L.value=F.value)},Y=()=>{F.value=L.value},j=e=>{const a=e.relatedTarget;(!a||!x.value?.contains(a))&&(L.value=F.value)};t(()=>{L.value="slider",x.value&&(x.value.addEventListener("keydown",z),x.value.addEventListener("keydown",V),x.value.addEventListener("focus",j,!0),x.value.addEventListener("focusin",K),x.value.addEventListener("focusout",Y))}),l(()=>{x.value&&(x.value.removeEventListener("keydown",z),x.value.removeEventListener("keydown",V),x.value.removeEventListener("focus",j,!0),x.value.removeEventListener("focusin",K),x.value.removeEventListener("focusout",Y))});const X=e=>{C("play",e)},Q=e=>{C("favorite",e)},Z=e=>{C("navigate",e)},{formatRuntime:J}=O(),ee=w(()=>d.items[D.value]),ae=w(()=>"Series"===ee.value?.Type),te=w(()=>ae.value?"Go to Show":"Play"),le=w(()=>ae.value?"fa-arrow-right":"fa-play"),ie=async e=>await k.loadImageUrl(e,d.getImageUrl,d.items),se=e=>B.value.has(e)?"":q.value.get(e)||"",ne=e=>{k.preloadImage(e)},oe=async()=>{const e=d.items[D.value];if(e){if(!$.value.has(e.Id)){const a=await ie(e.Id);a&&$.value.set(e.Id,a)}if(!q.value.has(e.Id)){const a=(e=>{if(y.isDemoMode.value)return"";try{return g.getImageUrl(e,"Logo",500)}catch(a){return""}})(e.Id);a&&q.value.set(e.Id,a)}}(async()=>{const e=(D.value+1)%d.items.length,a=(D.value-1+d.items.length)%d.items.length,t=await ie(d.items[e].Id);t&&($.value.set(d.items[e].Id,t),ne(t));const l=await ie(d.items[a].Id);l&&($.value.set(d.items[a].Id,l),ne(l))})()};return f(()=>D.value,()=>{oe()},{immediate:!0}),f(()=>d.items,()=>{d.items.length>0&&oe()},{immediate:!0}),(a,t)=>(v(),i("div",Ue,[d.title?(v(),i("h2",Re,m(d.title),1)):u("",!0),n("div",{ref_key:"sliderWrapper",ref:x,class:"hero-slider-wrapper",tabindex:"0",style:p({height:d.height}),"data-slider-id":d.sliderId},[n("div",Fe,[h(_,{name:"slide-fade"},{default:E(()=>{return[d.items[D.value]?(v(),i("div",{key:d.items[D.value].Id,class:"hero-slide"},[n("div",{class:"slide-background",onClick:t[0]||(t[0]=e=>Z(d.items[D.value]))},[n("img",{src:(a=d.items[D.value].Id,$.value.get(a)||""||d.items[D.value].ImageUrl),alt:d.items[D.value].Name,loading:"lazy",decoding:"async"},null,8,$e)]),n("div",{class:s(["slide-content",{slim:"600px"!==e.height}])},[se(d.items[D.value].Id)?(v(),i("img",{key:0,src:se(d.items[D.value].Id),alt:d.items[D.value].Name,class:"slide-logo",onError:t[1]||(t[1]=e=>(e=>{B.value.add(e),q.value.delete(e)})(d.items[D.value].Id))},null,40,qe)):(v(),i("h1",{key:1,class:"slide-title",style:p({fontSize:d.titleSize})},m(d.items[D.value].Name),5)),n("div",Be,[d.items[D.value]?.ProductionYear?(v(),i("span",We,m(d.items[D.value]?.ProductionYear),1)):u("",!0),d.items[D.value]?.CommunityRating?(v(),i("span",Ge," ⭐ "+m(d.items[D.value]?.CommunityRating?.toFixed(1)),1)):u("",!0),d.items[D.value]?.OfficialRating?(v(),i("span",He,m(d.items[D.value]?.OfficialRating),1)):u("",!0),d.items[D.value]?.RunTimeTicks?(v(),i("span",Ve,m(I(J)(d.items[D.value]?.RunTimeTicks)),1)):u("",!0)]),d.items[D.value]?.Genres?(v(),i("div",ze,[(v(!0),i(o,null,r(d.items[D.value]?.Genres?.slice(0,3),e=>(v(),i("span",{key:e,class:"genre-tag"},m(e),1))),128))])):u("",!0),d.items[D.value]?.Overview?(v(),i("p",Ke,m(d.items[D.value]?.Overview?.substring(0,150))+"... ",1)):u("",!0),n("div",Ye,[n("button",{tabindex:"-1",class:s(["btn-play",{focused:"play"===L.value}]),onClick:t[2]||(t[2]=e=>X(d.items[D.value]))},[n("i",{class:s(["fas",le.value])},null,2),S(" "+m(te.value),1)],2),d.showFavoriteButton?(v(),i("button",{key:0,tabindex:"-1",class:s(["btn-favorite",{focused:"favorite"===L.value}]),onClick:t[3]||(t[3]=e=>Q(d.items[D.value]))},[...t[4]||(t[4]=[n("i",{class:"fas fa-heart"},null,-1),S(" Add to Favorites ",-1)])],2)):u("",!0)])],2)])):u("",!0)];var a}),_:1})]),n("div",je,[(v(!0),i(o,null,r(d.items,(e,a)=>(v(),i("button",{key:e.Id,tabindex:"-1",class:s(["indicator",{active:D.value===a}]),onClick:e=>H(a),"aria-label":`Go to slide ${a+1}`},null,10,Xe))),128))])],12,Oe)]))}}),[["__scopeId","data-v-2740ae22"]]),Ze={class:"card-image"},Je=["src","alt"],ea={key:1,class:"placeholder-image"},aa={key:2,class:"placeholder-image"},ta={key:3,class:"watched-badge",title:"Watched"},la={key:4,class:"rating-badges"},ia=["title"],sa=["title"],na={key:5,class:"streaming-providers"},oa=["src","alt","title"],ra=["title"],ua={class:"card-info min-h-16"},ca={class:"card-title"},da={key:0,class:"card-year"},va=re(e({__name:"MediaCard",props:{item:{},imageUrl:{},streamingProviders:{}},emits:["click"],setup(e,{emit:t}){const l=e,c=t,d=a(),p=a(!1);F(d,{threshold:.01,rootMargin:"200px",onEnter:()=>{p.value=!0}});const f=e=>"Id"in e&&"Name"in e,g=e=>"title"in e&&!("name"in e),b=e=>"name"in e&&"first_air_date"in e,y=w(()=>f(l.item)?l.item.Name:g(l.item)?l.item.title:b(l.item)?l.item.name:""),h=w(()=>(l.item,f(l.item)?l.item.ProductionYear?.toString()||null:g(l.item)?l.item.release_date?new Date(l.item.release_date).getFullYear().toString():null:b(l.item)&&l.item.first_air_date?new Date(l.item.first_air_date).getFullYear().toString():null)),k=w(()=>l.imageUrl?l.imageUrl:f(l.item)?l.item.ImageUrl:null),I=w(()=>f(l.item)&&l.item.CommunityRating?{value:l.item.CommunityRating,display:`${(10*l.item.CommunityRating).toFixed(0)}%`}:!f(l.item)&&l.item.vote_average?{value:l.item.vote_average,display:`${(10*l.item.vote_average).toFixed(0)}%`}:null),E=w(()=>f(l.item)&&l.item.CriticRating?{value:l.item.CriticRating,display:`${l.item.CriticRating}%`}:null),C=w(()=>null!==I.value||null!==E.value),S=w(()=>!!f(l.item)&&!0===l.item.UserData?.Played),_=w(()=>{if(f(l.item)){if("Movie"===l.item.Type)return"movie";if("Series"===l.item.Type)return"tv"}else{if(g(l.item))return"movie";if(b(l.item))return"tv"}return null}),D=w(()=>l.streamingProviders?.slice(0,3)||[]);return(a,t)=>(v(),i("div",{ref_key:"cardRef",ref:d,class:"media-card",tabindex:"0",onClick:t[0]||(t[0]=a=>c("click",e.item)),onKeydown:t[1]||(t[1]=x(a=>c("click",e.item),["enter"]))},[n("div",Ze,[p.value&&k.value?(v(),i("img",{key:0,src:k.value,alt:y.value,loading:"lazy",decoding:"async"},null,8,Je)):p.value?(v(),i("div",aa,m(y.value),1)):(v(),i("div",ea," Loading... ")),S.value?(v(),i("div",ta,[...t[2]||(t[2]=[n("span",null,"Watched",-1)])])):u("",!0),C.value?(v(),i("div",la,[I.value?(v(),i("div",{key:0,class:"rating-badge community",title:`Audience Score: ${I.value.display}`},[t[3]||(t[3]=n("i",{class:"fas fa-users"},null,-1)),n("span",null,m(I.value.display),1)],8,ia)):u("",!0),E.value?(v(),i("div",{key:1,class:"rating-badge critic",title:`Critics Score: ${E.value.display}`},[t[4]||(t[4]=n("i",{class:"fas fa-star"},null,-1)),n("span",null,m(E.value.display),1)],8,sa)):u("",!0)])):u("",!0),D.value.length>0?(v(),i("div",na,[(v(!0),i(o,null,r(D.value,e=>{return v(),i("img",{key:e.provider_id,src:(a=e.logo_path,`https://image.tmdb.org/t/p/w92${a}`),alt:e.provider_name,title:`Available on ${e.provider_name}`,class:"provider-logo"},null,8,oa);var a}),128))])):u("",!0),_.value?(v(),i("div",{key:6,class:"media-type-icon",title:"movie"===_.value?"Movie":"TV Show"},[n("i",{class:s("movie"===_.value?"fas fa-film":"fas fa-tv")},null,2)],8,ra)):u("",!0)]),n("div",ua,[n("h3",ca,m(y.value),1),h.value?(v(),i("div",da,m(h.value),1)):u("",!0)])],544))}}),[["__scopeId","data-v-facdac43"]]),ma={class:"media-row","data-nav-zone":"media-row"},pa={class:"row-container","data-nav-container":"media-row"},fa={key:0,class:"loading-state"},ga=re(e({__name:"MediaRow",props:{items:{},loading:{type:Boolean},getImageUrl:{type:Function},loop:{type:Boolean}},emits:["itemClick","nearEnd"],setup(e,{emit:s}){const c=e,d=s,m=e=>"embyItem"in e&&"tmdbData"in e,p=e=>"Id"in e&&"Name"in e&&!("title"in e)&&!("name"in e),g=w(()=>c.loop&&0!==c.items.length?[...c.items,...c.items,...c.items]:c.items),b=a();let y=!1,h=null;const k=e=>{if(!b.value)return;const a=.8*b.value.clientWidth,t=b.value.scrollLeft+("right"===e?a:-a);b.value.scrollTo({left:t,behavior:"smooth"})},I=()=>{if(h)return;if(h=window.setTimeout(()=>{h=null},100),!b.value||y)return;const{scrollLeft:e,scrollWidth:a,clientWidth:t}=b.value;if(c.loop&&c.items.length>0){const t=a/3;e>=2*t?(y=!0,b.value.scrollLeft=e-t,setTimeout(()=>{y=!1},50)):e<=.1*t&&(y=!0,b.value.scrollLeft=e+t,setTimeout(()=>{y=!1},50))}else{(e+t)/a>=.7&&d("nearEnd")}},E=()=>{if(!b.value||c.loop)return;const{scrollWidth:e,clientWidth:a}=b.value;e<=a&&d("nearEnd")},C=()=>{if(b.value&&c.loop&&c.items.length>0){const e=b.value.scrollWidth/3;b.value.scrollLeft=e}};return f(()=>c.items,async()=>{await L(),setTimeout(E,100)},{immediate:!1}),t(()=>{b.value&&(b.value.addEventListener("scroll",I,{passive:!0}),setTimeout(C,100),setTimeout(E,150))}),l(()=>{b.value&&b.value.removeEventListener("scroll",I)}),(a,t)=>(v(),i("div",ma,[n("div",pa,[n("button",{class:"scroll-btn scroll-btn-left",tabindex:"-1",onClick:t[0]||(t[0]=e=>k("left")),"aria-label":"Scroll left"},[...t[2]||(t[2]=[n("i",{class:"fas fa-chevron-left"},null,-1)])]),n("div",{ref_key:"scrollContainer",ref:b,class:"row-content","data-nav-scrollable":"true"},[e.loading?(v(),i("div",fa,[(v(),i(o,null,r(6,e=>n("div",{key:e,class:"media-card-skeleton"})),64))])):u("",!0),(v(!0),i(o,null,r(g.value,(a,t)=>(v(),i(o,{key:`${m(a)?a.embyId:p(a)?a.Id:a.id}-${t}`},[m(a)?(v(),D(va,{key:0,item:a.embyItem,"image-url":e.getImageUrl(a.tmdbData)||void 0,"streaming-providers":a.streamingProviders,onClick:e=>d("itemClick",a.tmdbData)},null,8,["item","image-url","streaming-providers","onClick"])):p(a)?(v(),D(va,{key:1,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"])):(v(),D(va,{key:2,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"]))],64))),128))],512),n("button",{class:"scroll-btn scroll-btn-right",tabindex:"-1",onClick:t[1]||(t[1]=e=>k("right")),"aria-label":"Scroll right"},[...t[3]||(t[3]=[n("i",{class:"fas fa-chevron-right"},null,-1)])])])]))}}),[["__scopeId","data-v-90648296"]]),ba={class:"genre-filter","data-nav-zone":"genre-filter"},ya={class:"filter-container"},ha=["onClick","onKeydown","onFocus"],ka=re(e({__name:"GenreFilter",props:{genres:{},selectedGenres:{default:()=>[]},maxVisible:{default:8}},emits:["update:selectedGenres"],setup(e,{emit:t}){const l=e,u=t,c=a(),d=a([]),p=a(-1),f=e=>{const a=[...l.selectedGenres],t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e),u("update:selectedGenres",a)},g=()=>{u("update:selectedGenres",[])},b=w(()=>l.selectedGenres.length>0),y=e=>{if(!c.value||!d.value[e])return;const a=d.value[e],t=c.value,l=a.offsetLeft,i=l+a.offsetWidth,s=t.scrollLeft,n=t.clientWidth;l<s?t.scrollTo({left:l-20,behavior:"smooth"}):i>s+n&&t.scrollTo({left:i-n+20,behavior:"smooth"})},h=(e,a,t)=>{const i=l.genres.length+1;switch(e.key){case"ArrowLeft":0===a||(e.preventDefault(),e.stopPropagation(),p.value=a-1,L(()=>{d.value[p.value]?.focus(),y(p.value)}));break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),a<i-1&&(p.value=a+1,L(()=>{d.value[p.value]?.focus(),y(p.value)}));break;case"ArrowUp":case"ArrowDown":break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),0===a?g():void 0!==t&&f(t)}},k=e=>{p.value=e},I=(e,a)=>{e&&(d.value[a]=e)};return(a,t)=>(v(),i("div",ba,[n("div",ya,[n("div",{ref_key:"scrollContainer",ref:c,class:"genres-list"},[n("button",{ref:e=>I(e,0),class:s(["genre-pill",{active:!b.value}]),tabindex:"0",onClick:g,onKeydown:t[0]||(t[0]=e=>h(e,0)),onFocus:t[1]||(t[1]=e=>k(0))}," All ",34),(v(!0),i(o,null,r(e.genres,(e,a)=>{return v(),i("button",{key:e.id,ref_for:!0,ref:e=>I(e,a+1),class:s(["genre-pill",{active:(t=e.id,l.selectedGenres.includes(t))}]),tabindex:"0",onClick:a=>f(e.id),onKeydown:t=>h(t,a+1,e.id),onFocus:e=>k(a+1)},m(e.name),43,ha);var t}),128))],512)])]))}}),[["__scopeId","data-v-4ea3843b"]]),wa={class:"modal-container"},Ia={class:"modal-body"},Ea={key:0,class:"error-message"},Ca={class:"form-group"},Sa=re(e({__name:"TmdbApiKeyModal",emits:["close","submit"],setup(e,{emit:t}){const l=t,s=a(""),o=a(""),r=()=>{s.value,s.value.trim()?s.value.trim().length<32?o.value="API key appears to be invalid (too short)":l("submit",s.value.trim()):o.value="Please enter a valid API key"},d=()=>{l("close")};return(e,a)=>(v(),i("div",{class:"modal-overlay",onClick:c(d,["self"])},[n("div",wa,[n("div",{class:"modal-header"},[a[2]||(a[2]=n("h2",null,"TMDB API Key Required",-1)),n("button",{class:"close-button",onClick:d},[...a[1]||(a[1]=[n("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[n("path",{d:"M18 6L6 18M6 6l12 12","stroke-width":"2","stroke-linecap":"round"})],-1)])])]),n("div",Ia,[a[6]||(a[6]=n("p",{class:"description"}," To display trending movies and TV shows, we need a TMDB (The Movie Database) API key. This service is free and provides rich media information. ",-1)),o.value?(v(),i("div",Ea,m(o.value),1)):u("",!0),n("form",{onSubmit:c(r,["prevent"])},[n("div",Ca,[a[3]||(a[3]=n("label",{for:"tmdb-api-key"},"API Key",-1)),g(n("input",{id:"tmdb-api-key","onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),type:"text",placeholder:"Enter your TMDB API key",autocomplete:"off",spellcheck:"false"},null,512),[[b,s.value]])]),a[5]||(a[5]=n("div",{class:"info-section"},[n("p",{class:"info-text"},[S(" Don't have an API key? "),n("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",class:"register-link"}," Register for free on TMDB ")]),n("p",{class:"info-text small"}," After registering, you can find your API key in your account settings under the API section. ")],-1)),n("div",{class:"button-group"},[n("button",{type:"button",class:"btn-secondary",onClick:d}," Skip for Now "),a[4]||(a[4]=n("button",{type:"submit",class:"btn-primary"}," Save API Key ",-1))])],32)])])]))}}),[["__scopeId","data-v-5a9c93db"]]),_a={key:0,class:"movie-grid-container"},xa={key:0,class:"grid-title"},Da={class:"grid",style:{position:"relative"},"data-nav-zone":"movie-grid"},La=e({__name:"MovieGrid",props:{items:{},title:{},getImageUrl:{type:Function}},emits:["itemClick"],setup(e,{emit:l}){const s=e,c=l,d=a(),f=a(0),g=a(600),b=w(()=>{if(!d.value)return 4;const e=d.value.clientWidth;return Math.max(1,Math.floor(e/196))}),y=w(()=>Math.ceil(g.value/336)+2),h=w(()=>Math.max(0,Math.floor(f.value/336)-1)),k=w(()=>{const e=h.value+y.value;return Math.min(Math.ceil(s.items.length/b.value),e)}),I=w(()=>{const e=h.value*b.value,a=k.value*b.value;return s.items.slice(e,a)}),E=w(()=>336*h.value),C=e=>{const a=e.target;f.value=a.scrollTop,g.value=a.clientHeight};return t(()=>{d.value&&(g.value=d.value.clientHeight)}),(a,t)=>I.value?(v(),i("div",_a,[e.title?(v(),i("h2",xa,m(e.title),1)):u("",!0),n("div",{ref_key:"gridContainer",ref:d,class:"grid-wrapper",onScroll:C},[n("div",Da,[n("div",{style:p({transform:`translateY(${E.value}px)`})},[(v(!0),i(o,null,r(e.items,a=>(v(),D(va,{key:a.Id,item:a,"image-url":e.getImageUrl?e.getImageUrl(a.Id):a.ImageUrl,onClick:e=>c("itemClick",a)},null,8,["item","image-url","onClick"]))),128))],4)])],544)])):u("",!0)}}),Pa={class:"details-hero"},Ta={class:"hero-content"},Aa=["src","alt"],Ma={key:1,class:"hero-title"},Na={class:"hero-actions"},Ua={class:"hero-meta"},Ra={key:0,class:"meta-item"},Oa={key:1,class:"meta-item meta-rating-badge"},Fa={key:2,class:"meta-item"},$a={key:3,class:"meta-item meta-star-rating"},qa={key:2,class:"hero-genres"},Ba={key:0},Wa={key:3,class:"hero-overview"},Ga={class:"hero-extra-actions"},Ha=["title"],Va=re(e({__name:"MovieDetails",props:{item:{},imageUrl:{},backdropUrl:{},logoUrl:{}},emits:["play","back","browse","removeFromContinueWatching","markAsUnwatched"],setup(e,{emit:l}){const c=e,d=l,p=a(!1);t(()=>{const e=document.querySelector(".btn-hero-play");e&&e.focus()});const{formatRuntime:g,formatRating:b}=O(),y=w(()=>"BoxSet"===c.item.Type),h=w(()=>!0===c.item.UserData?.Played),k=()=>{c.item.Name,p.value=!0};f(()=>[c.item.Id,c.logoUrl],()=>{p.value=!1});const E=()=>{const e=document.querySelector(".main-content");e&&e.scrollTo({top:0,behavior:"smooth"})},C=(e,a)=>{if(e.key.startsWith("Arrow"))switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowLeft":if("play"===a){const e=document.querySelector(".sidebar .nav-item");e&&e.focus()}else if("back"===a){const e=document.querySelector(".btn-hero-play");e?.focus()}else if("mark"===a){const e=document.querySelector(".sidebar .nav-item");e&&e.focus()}break;case"ArrowRight":if("play"===a){const e=document.querySelector(".btn-hero-secondary");e?.focus()}else if("back"===a){const e=document.querySelector(".hero-extra-actions .btn-hero-secondary");e?.focus()}break;case"ArrowDown":if("play"===a||"back"===a){const e=document.querySelector(".hero-extra-actions .btn-hero-secondary");if(e)e.focus();else{const e=document.querySelector(".season-buttons button"),a=document.querySelector(".similar-titles .media-card");e?e.focus():a&&a.focus()}}else if("mark"===a){const e=document.querySelector(".season-buttons button"),a=document.querySelector(".similar-titles .media-card");e?e.focus():a&&a.focus()}break;case"ArrowUp":if("mark"===a){const e=document.querySelector(".btn-hero-play");e?.focus()}}};return(a,t)=>(v(),i("div",Pa,[n("div",Ta,[e.logoUrl&&!p.value?(v(),i("img",{key:0,src:e.logoUrl,alt:e.item.Name,class:"hero-logo",onError:k},null,40,Aa)):(v(),i("h1",Ma,m(e.item.Name),1)),n("div",Na,[y.value?(v(),i("button",{key:1,class:"btn-hero-play",onClick:t[2]||(t[2]=a=>d("browse",e.item)),onKeydown:t[3]||(t[3]=e=>C(e,"play")),onFocus:E},[...t[9]||(t[9]=[n("i",{class:"fas fa-folder-open"},null,-1),S(" Browse Collection ",-1)])],32)):(v(),i("button",{key:0,class:"btn-hero-play",tabindex:"0",onClick:t[0]||(t[0]=a=>d("play",e.item)),onKeydown:t[1]||(t[1]=e=>C(e,"play")),onFocus:E},[...t[8]||(t[8]=[n("i",{class:"fas fa-play"},null,-1),S(" Play Now ",-1)])],32)),n("button",{class:"btn-hero-secondary",tabindex:"0",onClick:t[4]||(t[4]=e=>d("back")),onKeydown:t[5]||(t[5]=e=>C(e,"back")),onFocus:E},[...t[10]||(t[10]=[n("i",{class:"fas fa-info-circle"},null,-1),S(" More Information ",-1)])],32)]),n("div",Ua,[e.item.ProductionYear?(v(),i("span",Ra,m(e.item.ProductionYear),1)):u("",!0),e.item.OfficialRating?(v(),i("span",Oa,m(e.item.OfficialRating),1)):u("",!0),e.item.RunTimeTicks?(v(),i("span",Fa,m(I(g)(e.item.RunTimeTicks)),1)):u("",!0),e.item.CommunityRating?(v(),i("span",$a,[t[11]||(t[11]=n("i",{class:"fas fa-star"},null,-1)),S(" "+m(I(b)(e.item.CommunityRating)),1)])):u("",!0)]),e.item.Genres&&e.item.Genres.length?(v(),i("div",qa,[(v(!0),i(o,null,r(e.item.Genres.slice(0,3),(a,t)=>(v(),i("span",{key:a},[S(m(a),1),t<Math.min(e.item.Genres.length,3)-1?(v(),i("span",Ba," • ")):u("",!0)]))),128))])):u("",!0),e.item.Overview?(v(),i("p",Wa,m(e.item.Overview),1)):u("",!0),n("div",Ga,[y.value?u("",!0):(v(),i("button",{key:0,class:"btn-hero-secondary",tabindex:"0",onClick:t[6]||(t[6]=a=>h.value?d("markAsUnwatched",e.item):d("removeFromContinueWatching",e.item)),onKeydown:t[7]||(t[7]=e=>C(e,"mark")),onFocus:E,title:h.value?"Mark as Unwatched":"Mark as Watched"},[S(m(h.value?"Mark as Unwatched":"Mark as Watched")+" ",1),n("i",{class:s(h.value?"fas fa-times":"fas fa-check")},null,2)],40,Ha))])])]))}}),[["__scopeId","data-v-d2ca501c"]]),za={class:"player-container"},Ka={key:0,class:"player-overlay"},Ya={class:"error-message"},ja={key:1,class:"skip-intro-container","data-nav-zone":"skip-controls"},Xa=["aria-label"],Qa={key:2,class:"media-sidebar","data-nav-zone":"media-sidebar"},Za={class:"media-card-player"},Ja={class:"media-poster"},et=["src","alt"],at={class:"media-info"},tt={key:0,class:"show-logo-container"},lt=["src","alt"],it={key:1,class:"show-title"},st={class:"show-genres"},nt={key:0},ot={class:"show-description"},rt={class:"up-next-section"},ut={class:"up-next-list"},ct=["aria-label"],dt={class:"up-next-thumbnail"},vt=["src","alt"],mt={class:"up-next-details"},pt={class:"up-next-episode"},ft={class:"top-bar"},gt={class:"top-bar-info"},bt={class:"episode-label"},yt={class:"episode-title"},ht={class:"top-bar-actions"},kt={class:"volume-menu-container"},wt={key:0,class:"context-menu volume-menu"},It={class:"volume-slider-container"},Et=["value"],Ct={class:"volume-percentage"},St={class:"bottom-controls"},_t={class:"control-buttons-row"},xt={class:"subtitle-menu-container"},Dt={key:0,class:"context-menu subtitle-menu"},Lt={key:0,class:"fas fa-check"},Pt=["onClick"],Tt={key:0,class:"fas fa-check"},At={class:"quality-menu-container"},Mt={key:0,class:"context-menu quality-menu"},Nt=["onClick"],Ut={key:0,class:"fas fa-check"},Rt=["aria-label"],Ot={class:"progress-bar-track"},Ft={class:"time-display"},$t={class:"time-current"},qt={class:"time-remaining"},Bt={class:"timezone-time"},Wt={class:"playback-buttons","data-nav-zone":"player-controls"},Gt=["aria-label","title"],Ht=["aria-label"],Vt=["aria-label","title"],zt=re(e({__name:"VideoPlayer",props:{item:{},streamUrl:{}},emits:["close","progress","playbackStart","playbackStop","switchEpisode"],setup(e,{emit:c}){const d=e,f=A(),g=$(),b=c,y=a(null),h=w(()=>d.streamUrl),k=a(0),E=a(0),C=w(()=>0===E.value?0:k.value/E.value*100),_=a(!0);let x=null;const D=a(!1),L=a(1),P=a(!1),T=a(!1),R=a(!1),O=a([]),F=a([]),B=a(null),W=a("Auto"),G=a(null),H=a(!1),V=a(null),z=a(!1),K=a("Skip Intro");let Y=null;const j=a(null),X=a(null),Q=w(()=>"Episode"===d.item.Type&&d.item.SeriesId),Z=e=>e/1e7,J=e=>Math.floor(1e7*e),{isPlaying:ee,errorMessage:ae,handlePlayPause:te,handleStop:le,handleSeek:ie}=q(y,h,{onProgress:(e,a)=>{b("progress",e,a)},onPlaybackStart:()=>{b("playbackStart")},onPlaybackStop:e=>{b("playbackStop",e)}}),se=()=>{y.value&&(k.value=y.value.currentTime,E.value=y.value.duration||0,ne())},ne=()=>{if(!y.value)return H.value=!1,void(z.value=!1);const e=J(k.value);if(G.value){const{IntroStart:a,IntroEnd:t}=G.value;if(e>=a&&e<=t)return H.value=!0,z.value=!1,void(K.value="Skip Intro")}if(V.value){const{CreditsStart:a,CreditsEnd:t}=V.value;if(e>=a&&e<=t)return H.value=!1,z.value=!0,void(K.value="Skip Credits")}H.value=!1,z.value=!1},oe=()=>{if(y.value){if(H.value&&G.value){const e=Z(G.value.IntroEnd);y.value.currentTime=e,H.value=!1}else if(z.value&&V.value){if(Q.value&&j.value)return j.value.Name,void ue();const e=Z(V.value.CreditsEnd);y.value.currentTime=e,z.value=!1}be()}},re=()=>{X.value&&(X.value.Name,b("switchEpisode",X.value.Id))},ue=()=>{j.value&&(j.value.Name,b("switchEpisode",j.value.Id))},ce=e=>{if(!isFinite(e))return"0:00";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},de=e=>{if(!e)return"";const a=e.ImageTags?.Primary||e.SeriesPrimaryImageTag,t=e.ImageTags?.Primary?e.Id:e.SeriesId||e.Id;return a&&f.serverUrl.value?`${f.serverUrl.value}/emby/Items/${t}/Images/Primary?tag=${a}&maxWidth=400`:""},ve=a(!1),me=e=>e&&f.serverUrl.value?ve.value?"":e.SeriesId?f.getImageUrl(e.SeriesId,"Logo",500):f.getImageUrl(e.Id,"Logo",500):"",pe=()=>{ve.value=!0},fe=()=>{if(!y.value)return"";const e=new Date,a=new Date(e),t=new Date(e.getTime()+1e3*(E.value-k.value)),l=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`;return`${l(a)} - ${l(t)}`},ge=e=>{if(!y.value)return;const a=e.currentTarget.getBoundingClientRect(),t=(e.clientX-a.left)/a.width*E.value;y.value.currentTime=t,be()},be=()=>{_.value=!0,null!==x&&clearTimeout(x),x=window.setTimeout(()=>{_.value=!1},3e3)},ye=()=>{be()},he=e=>{const a=e.target;a.closest(".subtitle-menu-container")||a.closest(".quality-menu-container")||a.closest(".volume-menu-container")||(T.value=!1,R.value=!1,P.value=!1)},ke=()=>{le(),b("close")},we=async()=>{const e=document.querySelector(".player-container");if(e){try{document.fullscreenElement?(await document.exitFullscreen(),D.value=!1):(await e.requestFullscreen(),D.value=!0)}catch(a){console.error("[VideoPlayer] Fullscreen error:",a)}be()}},Ie=()=>{D.value=!!document.fullscreenElement},Ee=e=>{const a=e.target,t=parseFloat(a.value);L.value=t,y.value&&(y.value.volume=t),be()},Ce=()=>{P.value=!P.value,P.value&&(T.value=!1,R.value=!1),be()},Se=()=>{T.value=!T.value,T.value&&(R.value=!1,P.value=!1),be()},_e=()=>{R.value=!R.value,R.value&&(T.value=!1,P.value=!1),be()},xe=e=>{if(B.value=e,!y.value)return;const a=y.value.textTracks;for(let t=0;t<a.length;t++)a[t].mode="disabled";null!==e&&a[e]&&(a[e].mode="showing"),T.value=!1,be(),null===e||O.value[e]},De=()=>{se(),setTimeout(()=>{(async()=>{try{if(!y.value||!y.value.duration)return;const e=y.value.duration;if(d.streamUrl.includes("BigBuckBunny")||d.streamUrl.includes("commondatastorage")){const a=Math.max(0,e-30),t=e;return void(V.value={CreditsStart:J(a),CreditsEnd:J(t),confidence:1,detectionMethod:"manual"})}const a=await g.getCreditsMarker(d.item.Id,d.item.SeriesId,null);if(a)return V.value=a,Z(a.CreditsStart),Z(a.CreditsEnd),a.confidence,void a.detectionMethod;Y=g.detectCreditsPassively(y.value,e=>{V.value=e,Z(e.CreditsStart),Z(e.CreditsEnd),e.confidence,d.item.SeriesId&&g.saveCreditsToStorage(d.item.SeriesId,d.item.Id,e),Y&&(Y(),Y=null)})}catch(e){console.error("[VideoPlayer] Failed to fetch credits markers:",e)}})()},5e3)},Le=e=>(M(e),N(e,U.MEDIA_PLAY_PAUSE)||N(e,U.MEDIA_PLAY)||N(e,U.MEDIA_PAUSE)?(e.preventDefault(),te(),void be()):N(e,U.MEDIA_STOP)?(e.preventDefault(),void ke()):N(e,U.MEDIA_REWIND)?(e.preventDefault(),ie(-10),void be()):N(e,U.MEDIA_FAST_FORWARD)?(e.preventDefault(),ie(10),void be()):N(e,U.MEDIA_TRACK_PREVIOUS)||N(e,U.CHANNEL_DOWN)?(e.preventDefault(),void(X.value&&re())):N(e,U.MEDIA_TRACK_NEXT)||N(e,U.CHANNEL_UP)?(e.preventDefault(),void(j.value&&ue())):N(e,U.CAPTION)?(e.preventDefault(),Se(),void be()):N(e,U.PICTURE_SIZE)?(e.preventDefault(),void we()):N(e,U.INFO)||N(e,U.MENU)||N(e,U.TOOLS)?(e.preventDefault(),void be()):N(e,U.EXIT)?(e.preventDefault(),void ke()):N(e,U.MEDIA_RECORD)?(e.preventDefault(),void be()):N(e,U.COLOR_RED)?(e.preventDefault(),void((H.value||z.value)&&oe())):N(e,U.COLOR_GREEN)?(e.preventDefault(),Se(),void be()):N(e,U.COLOR_YELLOW)?(e.preventDefault(),_e(),void be()):N(e,U.COLOR_BLUE)?(e.preventDefault(),void be()):void 0);return t(()=>{y.value&&(y.value.addEventListener("timeupdate",se),y.value.addEventListener("loadedmetadata",De),y.value.volume=L.value),document.addEventListener("mousemove",ye),document.addEventListener("focusin",ye),document.addEventListener("click",he),document.addEventListener("fullscreenchange",Ie),document.addEventListener("keydown",Le),be(),(async()=>{try{const e=await f.getIntroSkipMarkers(d.item.Id);G.value=e,e&&(Z(e.IntroStart),Z(e.IntroEnd))}catch(e){console.error("[VideoPlayer] Failed to fetch intro markers:",e)}})(),(async()=>{if(Q.value)try{const[e,a]=await Promise.all([f.getNextEpisode(d.item),f.getPreviousEpisode(d.item)]);j.value=e,X.value=a}catch(e){console.error("[VideoPlayer] Failed to fetch adjacent episodes:",e)}})(),(async()=>{try{const e=await f.getMediaSources(d.item.Id);if(e.length>0){const a=e[0];if(a.MediaStreams){O.value=a.MediaStreams.filter(e=>"Subtitle"===e.Type);const e=O.value.findIndex(e=>e.IsDefault);-1!==e&&(B.value=e),O.value;const t=a.MediaStreams.filter(e=>"Video"===e.Type);if(t.length>0){const e=t[0],a=[{label:"Auto",bitrate:14e7}];e.Height&&(e.Height>=2160?(a.push({label:"4K",bitrate:12e7,height:2160}),a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=1080?(a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=720?(a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):a.push({label:"480p",bitrate:3e6,height:480})),F.value=a,F.value}}}}catch(e){console.error("[VideoPlayer] Failed to fetch media info:",e)}})(),setTimeout(()=>{const e=document.querySelector(".control-btn-large");e&&e.focus()},100)}),l(()=>{y.value&&(y.value.removeEventListener("timeupdate",se),y.value.removeEventListener("loadedmetadata",De)),document.removeEventListener("mousemove",ye),document.removeEventListener("focusin",ye),document.removeEventListener("click",he),document.removeEventListener("fullscreenchange",Ie),document.removeEventListener("keydown",Le),null!==x&&clearTimeout(x),Y&&(Y(),Y=null)}),(a,t)=>(v(),i("div",za,[n("video",{ref_key:"videoElement",ref:y,class:"video-player",crossorigin:"anonymous"}," Your browser does not support the video tag. ",512),n("div",{class:s(["controls-gradient-backdrop",{"controls-hidden":!_.value}])},null,2),I(ae)?(v(),i("div",Ka,[n("div",Ya," ⚠️ "+m(I(ae)),1)])):u("",!0),H.value||z.value?(v(),i("div",ja,[n("button",{type:"button",onClick:oe,tabindex:"0",class:"skip-intro-btn player-control-btn","aria-label":K.value},[t[4]||(t[4]=n("i",{class:"fas fa-forward"},null,-1)),S(" "+m(K.value),1)],8,Xa)])):u("",!0),I(ee)?u("",!0):(v(),i("div",Qa,[n("div",Za,[n("div",Ja,[n("img",{src:de(e.item),alt:e.item.Name},null,8,et)]),n("div",at,[me(e.item)&&!ve.value?(v(),i("div",tt,[n("img",{src:me(e.item),alt:e.item.SeriesName||e.item.Name,class:"show-logo",onError:pe},null,40,lt)])):(v(),i("h2",it,m(e.item.SeriesName||e.item.Name),1)),n("div",st,[e.item.Genres&&e.item.Genres.length?(v(),i("span",nt,m(e.item.Genres.join(" • ")),1)):u("",!0)]),n("p",ot,m(e.item.Overview||"No description available."),1)]),n("div",rt,[t[8]||(t[8]=n("h3",{class:"up-next-title"},"UP NEXT",-1)),n("div",ut,[(v(),i(o,null,r(2,a=>n("div",{key:a,class:"up-next-item",tabindex:"0",role:"button","aria-label":`Episode ${a+6}`},[n("div",dt,[n("img",{src:de(e.item),alt:`Episode ${a+6}`},null,8,vt)]),n("div",mt,[t[5]||(t[5]=n("span",{class:"up-next-duration"},"20:18 - 20:48",-1)),n("span",pt,"Episode "+m(a+6),1),t[6]||(t[6]=n("h4",{class:"up-next-episode-title"},"Episode Title Goes Here",-1)),t[7]||(t[7]=n("button",{class:"add-watchlist-btn","aria-label":"Add to watchlist"},[n("i",{class:"fas fa-plus"}),S(" Add to watchlist ")],-1))])],8,ct)),64))])])])])),n("div",{class:s(["player-controls",{"controls-hidden":!_.value}])},[n("div",ft,[n("button",{type:"button",onClick:ke,class:"back-btn player-control-btn","aria-label":"Back"},[...t[9]||(t[9]=[n("i",{class:"fas fa-arrow-left"},null,-1)])]),n("div",gt,[n("span",bt,m(e.item.SeriesName)+" Season "+m(e.item.ParentIndexNumber)+" Episode "+m(e.item.IndexNumber),1),n("h2",yt,m(e.item.Name),1)]),n("div",ht,[n("div",kt,[n("button",{type:"button",onClick:Ce,tabindex:"0",class:"icon-btn player-control-btn","aria-label":"Volume"},[n("i",{class:s(0===L.value?"fas fa-volume-mute":L.value<.5?"fas fa-volume-down":"fas fa-volume-up")},null,2)]),P.value?(v(),i("div",wt,[t[12]||(t[12]=n("div",{class:"menu-header"},"Volume",-1)),n("div",It,[t[10]||(t[10]=n("i",{class:"fas fa-volume-up volume-icon-small"},null,-1)),n("input",{type:"range",min:"0",max:"1",step:"0.01",value:L.value,onInput:Ee,class:"volume-slider-vertical","aria-label":"Volume slider"},null,40,Et),t[11]||(t[11]=n("i",{class:"fas fa-volume-down volume-icon-small"},null,-1))]),n("div",Ct,m(Math.round(100*L.value))+"%",1)])):u("",!0)]),t[13]||(t[13]=n("button",{type:"button",class:"icon-btn player-control-btn","aria-label":"Cast"},[n("i",{class:"fas fa-cast"})],-1))])]),n("div",St,[n("div",_t,[n("div",xt,[n("button",{type:"button",onClick:Se,tabindex:"0",class:s(["icon-btn player-control-btn",{active:null!==B.value}]),"aria-label":"Subtitles"},[...t[14]||(t[14]=[n("i",{class:"fas fa-closed-captioning"},null,-1)])],2),T.value?(v(),i("div",Dt,[t[16]||(t[16]=n("div",{class:"menu-header"},"Subtitles",-1)),n("button",{type:"button",onClick:t[0]||(t[0]=e=>xe(null)),class:s(["menu-item",{active:null===B.value}])},[null===B.value?(v(),i("i",Lt)):u("",!0),t[15]||(t[15]=n("span",null,"Off",-1))],2),(v(!0),i(o,null,r(O.value,(e,a)=>(v(),i("button",{key:a,type:"button",onClick:e=>xe(a),class:s(["menu-item",{active:B.value===a}])},[B.value===a?(v(),i("i",Tt)):u("",!0),n("span",null,m(e.DisplayTitle||e.Language||`Track ${a+1}`),1)],10,Pt))),128))])):u("",!0)]),n("div",At,[n("button",{type:"button",onClick:_e,tabindex:"0",class:"icon-btn player-control-btn","aria-label":"Quality"},[...t[17]||(t[17]=[n("i",{class:"fas fa-cog"},null,-1)])]),R.value?(v(),i("div",Mt,[t[18]||(t[18]=n("div",{class:"menu-header"},"Quality",-1)),(v(!0),i(o,null,r(F.value,e=>(v(),i("button",{key:e.label,type:"button",onClick:a=>(e=>{W.value=e,R.value=!1,be()})(e.label),class:s(["menu-item",{active:W.value===e.label}])},[W.value===e.label?(v(),i("i",Ut)):u("",!0),n("span",null,m(e.label),1)],10,Nt))),128))])):u("",!0)]),n("button",{type:"button",onClick:we,tabindex:"0",class:"icon-btn player-control-btn","aria-label":D.value?"Exit fullscreen":"Enter fullscreen"},[n("i",{class:s(D.value?"fas fa-compress":"fas fa-expand")},null,2)],8,Rt)]),n("div",{class:"progress-bar-container",onClick:ge},[n("div",Ot,[n("div",{class:"progress-bar-fill",style:p({width:C.value+"%"})},null,4)])]),n("div",Ft,[n("span",$t,m(ce(k.value)),1),n("span",qt,m(ce(E.value)),1)]),n("div",Bt,m(fe()),1),n("div",Wt,[Q.value&&X.value?(v(),i("button",{key:0,type:"button",onClick:re,tabindex:"0",class:"control-btn player-control-btn","aria-label":`Previous episode: ${X.value.Name}`,title:`Previous: ${X.value.Name}`},[...t[19]||(t[19]=[n("i",{class:"fas fa-step-backward"},null,-1)])],8,Gt)):u("",!0),n("button",{type:"button",onClick:t[1]||(t[1]=e=>I(ie)(-10)),tabindex:"0",class:"control-btn player-control-btn","aria-label":"Rewind 10 seconds"},[...t[20]||(t[20]=[n("i",{class:"fas fa-backward"},null,-1)])]),n("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>I(te)&&I(te)(...e)),tabindex:"0",class:"control-btn control-btn-large player-control-btn","aria-label":I(ee)?"Pause":"Play"},[n("i",{class:s(I(ee)?"fas fa-pause":"fas fa-play")},null,2)],8,Ht),n("button",{type:"button",onClick:t[3]||(t[3]=e=>I(ie)(10)),tabindex:"0",class:"control-btn player-control-btn","aria-label":"Forward 10 seconds"},[...t[21]||(t[21]=[n("i",{class:"fas fa-forward"},null,-1)])]),Q.value&&j.value?(v(),i("button",{key:1,type:"button",onClick:ue,tabindex:"0",class:"control-btn player-control-btn","aria-label":`Next episode: ${j.value.Name}`,title:`Next: ${j.value.Name}`},[...t[22]||(t[22]=[n("i",{class:"fas fa-step-forward"},null,-1)])],8,Vt)):u("",!0)])])],2)]))}}),[["__scopeId","data-v-a2778546"]]);export{G as C,ka as G,Qe as H,Ie as L,ga as M,Sa as T,zt as V,re as _,La as a,va as b,Va as c,Ne as d};
