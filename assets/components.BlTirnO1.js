import{d as e,r as a,o as t,a as l,c as i,n as s,b as o,F as n,e as r,f as u,w as c,u as d,g as v,t as m,h as p,i as g,j as f,k as y,v as b,l as h,m as k,p as w,q as I,s as S,x as C,y as x,z as E,T as _,A as P,B as T}from"./vue-vendor.BVNoDdZ5.js";import{u as L,a as M,b as D,c as A,d as U,e as N,f as R,g as F}from"./composables.Cfo3sM-Q.js";const V=""+new URL("EmbyFlix-logo.CCoAMb74.png",import.meta.url).href,K=440,$={MEDIA_CARD_SMALL:220,MEDIA_CARD_DEFAULT:300,MEDIA_CARD_LARGE:K,EPISODE_CARD:500,HERO_SLIDER:1920,BACKDROP_DEFAULT:1280,SIDEBAR_THUMB:154,DETAILS_POSTER:K},B={class:"sidebar w-[300px] transition-[width] duration-800"},q={class:"sidebar-nav","data-nav-container":"sidebar"},W=["onClick"],G={class:"nav-text"},H={class:"opacity-0 transition-opacity duration-300 group-focus-within:opacity-50 group-hover:opacity-50 focus-within:!opacity-100 hover:!opacity-100"},O={key:0,class:"continue-watching-container mt-8 mb-25"},z={class:"continue-watching-list",style:{"list-style":"none"}},j=["onKeydown"],Y={class:"absolute inset-0 overflow-hidden z-0 rounded-xl"},Q=["src","alt"],X={class:"flex flex-col justify-between z-1 relative h-40 w-full self-end px-4 pb-1 bg-gradient-to-t from-black/30 to-transparent group-focus/item:from-black/0"},J={class:"item-title-wrapper"},Z={class:"item-title font-bold text-white text-shadow"},ee={key:0,class:"bg-black bg-opacity-30"},ae={class:"bottom-row w-full"},te={class:"progress-details flex justify-between w-full items-center"},le={class:"flex bg-gray-600 bg-opacity-50 backdrop-blur-sm text-white px-2 rounded h-8 items-center justify-between gap-2"},ie={key:0},se=(e,a)=>{const t=e.__vccOpts||e;for(const[l,i]of a)t[l]=i;return t},oe=se(e({__name:"Sidebar",props:{activeNavItem:{},userName:{}},emits:["navigate","logout"],setup(e,{emit:f}){const y=f,b=d(),h=D(),k=L(),w=M(),I=a([]),S=[{id:"home",icon:"fas fa-home",text:"Home"},{id:"movies",icon:"fas fa-film",text:"Movies"},{id:"tvshows",icon:"fas fa-tv",text:"TV Shows"},{id:"collections",icon:"fas fa-folder",text:"Collections"},{id:"search",icon:"fas fa-search",text:"Search"},{id:"settings",icon:"fas fa-cog",text:"Settings"}],C=()=>{y("logout")},x=async()=>{if(h.isDemoMode.value)I.value=k.getContinueWatching();else try{const e=await w.getContinueWatching(),a=e.reduce((e,a)=>{const t=a.SeriesName||a.Name,l=a.ProductionYear;return e.some(e=>{const a=e.SeriesName||e.Name,i=e.ProductionYear;return a===t&&i===l})||e.push(a),e},[]);I.value=a,console.log("[Sidebar] Loaded continue watching items:",a.length,"unique items from",e.length,"total items")}catch(e){console.error("[Sidebar] Failed to load continue watching:",e)}},E=e=>h.isDemoMode.value?e.ImageUrl||"":w.getImageUrl(e.Id,"Primary",$.MEDIA_CARD_DEFAULT),_=e=>e.UserData?.PlaybackPositionTicks&&e.RunTimeTicks?Math.round(e.UserData.PlaybackPositionTicks/e.RunTimeTicks*100):0,P=e=>"Episode"===e.Type&&e.ParentIndexNumber&&e.IndexNumber?`S${e.ParentIndexNumber} E${e.IndexNumber}`:"",T=()=>{console.log("[Sidebar] Refreshing continue watching list"),x()},A=a(!1);return t(()=>{x(),window.addEventListener("refresh-continue-watching",T),setTimeout(()=>{A.value=!0},50)}),l(()=>{window.removeEventListener("refresh-continue-watching",T)}),(a,t)=>(v(),i("div",{class:s(["group sidebar-wrapper",{"enable-transition":A.value}]),"data-nav-zone":"sidebar"},[o("div",B,[o("nav",q,[(v(),i(n,null,r(S,a=>o("a",{key:a.id,href:"#",class:s(["nav-item",{active:e.activeNavItem===a.id}]),onClick:c(e=>y("navigate",a.id),["prevent"])},[o("i",{class:s(a.icon+" nav-icon")},null,2),o("span",G,m(a.text),1)],10,W)),64)),o("div",H,[I.value.length>0?(v(),i("div",O,[t[1]||(t[1]=o("h3",{class:"pl-2 mb-3 text-white font-semibold"},"Continue Watching",-1)),o("ul",z,[(v(!0),i(n,null,r(I.value,e=>(v(),i("li",{key:e.Id,class:"continue-watching-item relative overflow-hidden mb-3"},[o("div",{class:"item-wrapper bg-black min-h-45 rounded-xl relative flex cursor-pointer group/item",onKeydown:p(a=>(e=>{b.push({name:"Player",params:{itemId:e.Id}})})(e),["enter"]),tabindex:"0"},[o("div",Y,[o("img",{class:"w-full h-full object-cover",src:E(e),alt:e.SeriesName||e.Name,loading:"lazy",decoding:"async"},null,8,Q)]),o("div",X,[o("div",J,[o("span",Z,m(e.SeriesName||e.Name),1),_(e)?(v(),i("div",ee,[o("div",{class:"progress-bar bg-[#13ff00] h-1 mt-2 shadow-sm rounded-sm",style:g({width:_(e)+"%"})},null,4)])):u("",!0)]),o("div",ae,[o("div",te,[t[0]||(t[0]=o("span",{class:"btn-overlay bg-gray-600 bg-opacity-50 backdrop-blur-sm rounded-full w-8 h-8 flex justify-center items-center text-white"},[o("i",{class:"fas fa-play"})],-1)),o("div",le,[P(e)?(v(),i("span",ie,m(P(e)),1)):u("",!0),o("span",null,m(_(e))+"%",1)])])])])],40,j)]))),128))])])):u("",!0)]),o("a",{href:"#",class:"nav-item logout-item",onClick:c(C,["prevent"])},[...t[2]||(t[2]=[o("i",{class:"fas fa-sign-out-alt nav-icon"},null,-1),o("span",{class:"nav-text"},"Logout",-1)])])])])],2))}}),[["__scopeId","data-v-f49400db"]]),ne={class:"search-container flex-1 flex items-center justify-end px-8"},re={class:"search-wrapper relative w-full max-w-125"},ue=se(e({__name:"Header",setup(e){const t=d(),l=h(),n=a(""),r=a(!1);f(()=>l.query.q,e=>{"Search"===l.name&&(n.value=e||"")},{immediate:!0}),f(n,e=>{"Search"===l.name&&e.trim()&&t.replace({name:"Search",query:{q:e.trim()}})});const u=e=>{"Enter"===e.key&&n.value.trim()&&t.push({name:"Search",query:{q:n.value.trim()}})},c=()=>{t.push({name:"Search"})};return(e,a)=>(v(),i("div",ne,[o("div",re,[o("i",{class:"fas fa-search search-icon absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer",onClick:c}),y(o("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),type:"text",placeholder:"Movies, series, shows...",class:s(["search-input w-full h-12 pl-12 pr-12 rounded-lg bg-gray-800/80 text-white border-none transition-all",{"bg-gray-700/90":r.value}]),onFocus:a[1]||(a[1]=e=>r.value=!0),onBlur:a[2]||(a[2]=e=>r.value=!1),onKeydown:u,onClick:c,tabindex:"0"},null,34),[[b,n.value]])])]))}}),[["__scopeId","data-v-b282c8dc"]]),ce={class:"layout"},de={key:0,class:"global-backdrop"},ve=["src"],me={class:"header"},pe={class:"content"},ge={class:"main-content px-7.5"},fe=se(e({__name:"BaseLayout",props:{activeNavItem:{},userName:{}},emits:["navigate","logout","search"],setup(e,{emit:s}){const n=s,r=a(""),c=e=>{n("search",e)},d=e=>{const a=e;r.value=a.detail||""};return t(()=>{const e=document.querySelector(".sidebar .nav-item");e&&e.focus(),window.addEventListener("update-backdrop",d)}),l(()=>{window.removeEventListener("update-backdrop",d)}),(a,t)=>(v(),i("div",ce,[r.value?(v(),i("div",de,[o("img",{src:r.value,alt:"Backdrop",class:"backdrop-image"},null,8,ve),t[2]||(t[2]=o("div",{class:"backdrop-gradient"},null,-1))])):u("",!0),o("div",me,[t[3]||(t[3]=o("div",{class:"logo-container w-75 h-full flex items-center b-bottom-1 border-primary-color border-1 pl-5"},[o("img",{src:V,alt:"EmbyFlix",class:"header-logo"})],-1)),k(ue,{onSearch:c})]),o("div",pe,[k(oe,{"active-nav-item":e.activeNavItem,"user-name":e.userName,onNavigate:t[0]||(t[0]=e=>n("navigate",e)),onLogout:t[1]||(t[1]=e=>n("logout"))},null,8,["active-nav-item","user-name"]),o("div",ge,[w(a.$slots,"default",{},void 0)])])]))}}),[["__scopeId","data-v-bc554bd1"]]),ye={key:0,class:"layout-wrapper"},be={key:1,class:"no-layout-wrapper"},he=se(e({__name:"LayoutWrapper",setup(e){const t=h(),l=d(),s=D(),o=a("home"),n=I(()=>t.meta.layout||"none"),r=I(()=>"base"===n.value);f(()=>t.name,e=>{switch(e){case"Home":default:o.value="home";break;case"Search":o.value="search";break;case"Details":o.value="details"}},{immediate:!0});const u=e=>{switch(o.value=e,e){case"home":l.push({name:"Home"});break;case"search":l.push({name:"Search"});break;case"movies":case"tvshows":case"collections":case"settings":l.push({name:"Home"});const a=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(a);break;default:const t=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(t)}},c=()=>{s.logout(),l.push({name:"Login"})},m=e=>{const a=new CustomEvent("app-search",{detail:e});window.dispatchEvent(a)};return(e,a)=>{const t=x("RouterView");return r.value?(v(),i("div",ye,[k(fe,{"active-nav-item":o.value,"user-name":S(s).currentUser.value?.Name||"User",onNavigate:u,onLogout:c,onSearch:m},{default:C(()=>[k(t)]),_:1},8,["active-nav-item","user-name"])])):(v(),i("div",be,[k(t)]))}}}),[["__scopeId","data-v-52626496"]]),ke={class:"login-container"},we={key:0,class:"error-message"},Ie={class:"form-group"},Se=["disabled"],Ce={class:"form-group"},xe=["disabled"],Ee={class:"form-group"},_e=["disabled"],Pe=["disabled"],Te=["disabled"],Le=e({__name:"LoginForm",props:{isLoading:{type:Boolean},error:{}},setup(e){const t=d(),l=D(),n=M(),r=a("http://localhost:8096"),c=a(""),p=a(""),g=a(""),f=async e=>{if(e&&e.preventDefault(),r.value&&c.value)try{const e=await n.authenticateByName(r.value,c.value,p.value);l.login(e.User),t.push({name:"Home"})}catch(a){g.value=a,console.error("Login failed:",a)}},h=()=>{l.enableDemoMode(),t.push({name:"Home"})};return(a,t)=>(v(),i("div",ke,[o("div",{class:s(["login-box",{"bg-red":g.value}])},[t[6]||(t[6]=o("div",{class:"logo-wrapper"},[o("img",{src:V,alt:"EmbyFlix",class:"login-logo"})],-1)),t[7]||(t[7]=o("p",null,"Connect to your Emby Server",-1)),g.value?(v(),i("div",we,m(g.value),1)):u("",!0),o("form",{onSubmit:f},[o("div",Ie,[t[3]||(t[3]=o("label",{for:"server-url"},"Server URL",-1)),y(o("input",{id:"server-url","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"https://your-server:8096",disabled:e.isLoading},null,8,Se),[[b,r.value]])]),o("div",Ce,[t[4]||(t[4]=o("label",{for:"username"},"Username",-1)),y(o("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),type:"text",placeholder:"Enter username",disabled:e.isLoading},null,8,xe),[[b,c.value]])]),o("div",Ee,[t[5]||(t[5]=o("label",{for:"password"},"Password",-1)),y(o("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),type:"password",placeholder:"Enter password",disabled:e.isLoading},null,8,_e),[[b,p.value]])]),o("button",{type:"submit",class:"btn-primary",disabled:e.isLoading||!r.value||!c.value||!p.value||p.value.length<8},m(e.isLoading?"Connecting...":"Connect to Server"),9,Pe),o("button",{type:"button",class:"btn-secondary",disabled:e.isLoading,onClick:h}," Demo Mode (Test UI) ",8,Te)],32)],2)]))}}),Me={class:"card-image"},De=["src","alt"],Ae={key:1,class:"placeholder-image"},Ue={key:2,class:"placeholder-image"},Ne={key:3,class:"watched-badge",title:"Watched"},Re={key:4,class:"rating-badges"},Fe=["title"],Ve=["title"],Ke={key:5,class:"streaming-providers"},$e=["src","alt","title"],Be=["title"],qe={class:"card-info min-h-16"},We={class:"card-title"},Ge={key:0,class:"card-year"},He=se(e({__name:"MediaCard",props:{item:{},imageUrl:{},streamingProviders:{}},emits:["click"],setup(e,{emit:t}){const l=e,c=t,d=a(),g=a(!1);A(d,{threshold:.01,rootMargin:"200px",onEnter:()=>{g.value=!0}});const f=e=>"Id"in e&&"Name"in e,y=e=>"title"in e&&!("name"in e),b=e=>"name"in e&&"first_air_date"in e,h=I(()=>f(l.item)?l.item.Name:y(l.item)?l.item.title:b(l.item)?l.item.name:""),k=I(()=>(console.log("item::",l.item),f(l.item)?l.item.ProductionYear?.toString()||null:y(l.item)?l.item.release_date?new Date(l.item.release_date).getFullYear().toString():null:b(l.item)&&l.item.first_air_date?new Date(l.item.first_air_date).getFullYear().toString():null)),w=I(()=>l.imageUrl?l.imageUrl:f(l.item)?l.item.ImageUrl:null),S=I(()=>f(l.item)&&l.item.CommunityRating?{value:l.item.CommunityRating,display:`${(10*l.item.CommunityRating).toFixed(0)}%`}:!f(l.item)&&l.item.vote_average?{value:l.item.vote_average,display:`${(10*l.item.vote_average).toFixed(0)}%`}:null),C=I(()=>f(l.item)&&l.item.CriticRating?{value:l.item.CriticRating,display:`${l.item.CriticRating}%`}:null),x=I(()=>null!==S.value||null!==C.value),E=I(()=>!!f(l.item)&&!0===l.item.UserData?.Played),_=I(()=>{if(f(l.item)){if("Movie"===l.item.Type)return"movie";if("Series"===l.item.Type)return"tv"}else{if(y(l.item))return"movie";if(b(l.item))return"tv"}return null}),P=I(()=>l.streamingProviders?.slice(0,3)||[]);return(a,t)=>(v(),i("div",{ref_key:"cardRef",ref:d,class:"media-card",tabindex:"0",onClick:t[0]||(t[0]=a=>c("click",e.item)),onKeydown:t[1]||(t[1]=p(a=>c("click",e.item),["enter"]))},[o("div",Me,[g.value&&w.value?(v(),i("img",{key:0,src:w.value,alt:h.value,loading:"lazy",decoding:"async"},null,8,De)):g.value?(v(),i("div",Ue,m(h.value),1)):(v(),i("div",Ae," Loading... ")),E.value?(v(),i("div",Ne,[...t[2]||(t[2]=[o("span",null,"Watched",-1)])])):u("",!0),x.value?(v(),i("div",Re,[S.value?(v(),i("div",{key:0,class:"rating-badge community",title:`Audience Score: ${S.value.display}`},[t[3]||(t[3]=o("i",{class:"fas fa-users"},null,-1)),o("span",null,m(S.value.display),1)],8,Fe)):u("",!0),C.value?(v(),i("div",{key:1,class:"rating-badge critic",title:`Critics Score: ${C.value.display}`},[t[4]||(t[4]=o("i",{class:"fas fa-star"},null,-1)),o("span",null,m(C.value.display),1)],8,Ve)):u("",!0)])):u("",!0),P.value.length>0?(v(),i("div",Ke,[(v(!0),i(n,null,r(P.value,e=>{return v(),i("img",{key:e.provider_id,src:(a=e.logo_path,`https://image.tmdb.org/t/p/original${a}`),alt:e.provider_name,title:`Available on ${e.provider_name}`,class:"provider-logo"},null,8,$e);var a}),128))])):u("",!0),_.value?(v(),i("div",{key:6,class:"media-type-icon",title:"movie"===_.value?"Movie":"TV Show"},[o("i",{class:s("movie"===_.value?"fas fa-film":"fas fa-tv")},null,2)],8,Be)):u("",!0)]),o("div",qe,[o("h3",We,m(h.value),1),k.value?(v(),i("div",Ge,m(k.value),1)):u("",!0)])],544))}}),[["__scopeId","data-v-27f561d5"]]),Oe={key:0,class:"movie-grid-container"},ze={key:0,class:"grid-title"},je={class:"grid",style:{position:"relative"},"data-nav-zone":"movie-grid"},Ye=e({__name:"MovieGrid",props:{items:{},title:{},getImageUrl:{type:Function}},emits:["itemClick"],setup(e,{emit:l}){const s=e,c=l,d=a(),p=a(0),f=a(600),y=I(()=>{if(!d.value)return 4;const e=d.value.clientWidth;return Math.max(1,Math.floor(e/196))}),b=I(()=>Math.ceil(f.value/336)+2),h=I(()=>Math.max(0,Math.floor(p.value/336)-1)),k=I(()=>{const e=h.value+b.value;return Math.min(Math.ceil(s.items.length/y.value),e)}),w=I(()=>{const e=h.value*y.value,a=k.value*y.value;return s.items.slice(e,a)}),S=I(()=>336*h.value),C=e=>{console.log("HandleScroll",e);const a=e.target;p.value=a.scrollTop,f.value=a.clientHeight};return t(()=>{d.value&&(f.value=d.value.clientHeight)}),(a,t)=>w.value?(v(),i("div",Oe,[e.title?(v(),i("h2",ze,m(e.title),1)):u("",!0),o("div",{ref_key:"gridContainer",ref:d,class:"grid-wrapper",onScroll:C},[o("div",je,[o("div",{style:g({transform:`translateY(${S.value}px)`})},[(v(!0),i(n,null,r(e.items,a=>(v(),E(He,{key:a.Id,item:a,"image-url":e.getImageUrl?e.getImageUrl(a.Id):a.ImageUrl,onClick:e=>c("itemClick",a)},null,8,["item","image-url","onClick"]))),128))],4)])],544)])):u("",!0)}}),Qe={class:"hero-slider-container"},Xe={key:0,class:"slider-section-title"},Je=["data-slider-id"],Ze={class:"hero-slider"},ea=["src","alt"],aa=["src","alt"],ta={class:"slide-meta"},la={key:0,class:"meta-item"},ia={key:1,class:"meta-item rating"},sa={key:2,class:"meta-item"},oa={key:3,class:"meta-item"},na={key:2,class:"slide-genres"},ra={key:3,class:"slide-description"},ua={class:"slide-actions"},ca={class:"slider-indicators"},da=["onClick","aria-label"],va=se(e({__name:"HeroSlider",props:{items:{},getImageUrl:{},title:{},showFavoriteButton:{type:Boolean,default:!0},height:{default:"600px"},titleSize:{default:"3rem"},sliderId:{default:"hero"}},emits:["play","favorite","navigate"],setup(e,{emit:c}){const d=e,p=M(),y=L(),b=D(),h=U(p,y,b.isDemoMode),w=c,x=a(),E=a(0),T=a("slider"),A=a("slider"),R=a(new Map),F=a(new Map),V=a(new Set),K=()=>{E.value=(E.value+1)%d.items.length},$=e=>{if(x.value===document.activeElement)switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),"slider"===T.value?O(d.items[E.value]):"play"===T.value?G(d.items[E.value]):"favorite"===T.value&&H(d.items[E.value]);break;case"ArrowLeft":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value)if(0===E.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"left"});window.dispatchEvent(e)}else E.value=(E.value-1+d.items.length)%d.items.length;else"play"===T.value?T.value="slider":"favorite"===T.value&&(T.value="play");break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),"slider"===T.value?K():"play"===T.value?d.showFavoriteButton?T.value="favorite":(K(),T.value="slider"):"favorite"===T.value&&(K(),T.value="slider");break;case"ArrowDown":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value)T.value="play";else if("play"===T.value||"favorite"===T.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"down"});window.dispatchEvent(e)}break;case"ArrowUp":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"up"});window.dispatchEvent(e)}else("play"===T.value||"favorite"===T.value)&&(T.value="slider")}},B=e=>{const a=e.relatedTarget;(!a||!x.value?.contains(a))&&(T.value=A.value)},q=()=>{A.value=T.value},W=e=>{const a=e.relatedTarget;(!a||!x.value?.contains(a))&&(T.value=A.value)};t(()=>{T.value="slider",x.value&&(x.value.addEventListener("keydown",$),x.value.addEventListener("focus",W,!0),x.value.addEventListener("focusin",B),x.value.addEventListener("focusout",q))}),l(()=>{x.value&&(x.value.removeEventListener("keydown",$),x.value.removeEventListener("focus",W,!0),x.value.removeEventListener("focusin",B),x.value.removeEventListener("focusout",q))});const G=e=>{w("play",e)},H=e=>{w("favorite",e)},O=e=>{w("navigate",e)},{formatRuntime:z}=N(),j=I(()=>d.items[E.value]),Y=I(()=>"Series"===j.value?.Type),Q=I(()=>Y.value?"Go to Show":"Play"),X=I(()=>Y.value?"fa-arrow-right":"fa-play"),J=async e=>await h.loadImageUrl(e,d.getImageUrl,d.items),Z=e=>V.value.has(e)?"":F.value.get(e)||"",ee=e=>{h.preloadImage(e)},ae=async()=>{const e=d.items[E.value];if(e){if(!R.value.has(e.Id)){const a=await J(e.Id);a&&R.value.set(e.Id,a)}if(!F.value.has(e.Id)){const a=(e=>{if(b.isDemoMode.value)return"";try{return p.getImageUrl(e,"Logo",500)}catch(a){return""}})(e.Id);a&&F.value.set(e.Id,a)}}(async()=>{const e=(E.value+1)%d.items.length,a=(E.value-1+d.items.length)%d.items.length,t=await J(d.items[e].Id);t&&(R.value.set(d.items[e].Id,t),ee(t));const l=await J(d.items[a].Id);l&&(R.value.set(d.items[a].Id,l),ee(l))})()};return f(()=>E.value,()=>{ae()},{immediate:!0}),f(()=>d.items,()=>{d.items.length>0&&ae()},{immediate:!0}),(a,t)=>(v(),i("div",Qe,[d.title?(v(),i("h2",Xe,m(d.title),1)):u("",!0),o("div",{ref_key:"sliderWrapper",ref:x,class:"hero-slider-wrapper",tabindex:"0",style:g({height:d.height}),"data-slider-id":d.sliderId},[o("div",Ze,[k(_,{name:"slide-fade"},{default:C(()=>{return[d.items[E.value]?(v(),i("div",{key:d.items[E.value].Id,class:"hero-slide"},[o("div",{class:"slide-background",onClick:t[0]||(t[0]=e=>O(d.items[E.value]))},[o("img",{src:(a=d.items[E.value].Id,R.value.get(a)||""||d.items[E.value].ImageUrl),alt:d.items[E.value].Name,loading:"lazy",decoding:"async"},null,8,ea)]),o("div",{class:s(["slide-content",{slim:"600px"!==e.height}])},[Z(d.items[E.value].Id)?(v(),i("img",{key:0,src:Z(d.items[E.value].Id),alt:d.items[E.value].Name,class:"slide-logo",onError:t[1]||(t[1]=e=>(e=>{console.log(`[HeroSlider] Logo failed to load for item: ${e}`),V.value.add(e),F.value.delete(e)})(d.items[E.value].Id))},null,40,aa)):(v(),i("h1",{key:1,class:"slide-title",style:g({fontSize:d.titleSize})},m(d.items[E.value].Name),5)),o("div",ta,[d.items[E.value]?.ProductionYear?(v(),i("span",la,m(d.items[E.value]?.ProductionYear),1)):u("",!0),d.items[E.value]?.CommunityRating?(v(),i("span",ia," ⭐ "+m(d.items[E.value]?.CommunityRating?.toFixed(1)),1)):u("",!0),d.items[E.value]?.OfficialRating?(v(),i("span",sa,m(d.items[E.value]?.OfficialRating),1)):u("",!0),d.items[E.value]?.RunTimeTicks?(v(),i("span",oa,m(S(z)(d.items[E.value]?.RunTimeTicks)),1)):u("",!0)]),d.items[E.value]?.Genres?(v(),i("div",na,[(v(!0),i(n,null,r(d.items[E.value]?.Genres?.slice(0,3),e=>(v(),i("span",{key:e,class:"genre-tag"},m(e),1))),128))])):u("",!0),d.items[E.value]?.Overview?(v(),i("p",ra,m(d.items[E.value]?.Overview?.substring(0,150))+"... ",1)):u("",!0),o("div",ua,[o("button",{tabindex:"-1",class:s(["btn-play",{focused:"play"===T.value}]),onClick:t[2]||(t[2]=e=>G(d.items[E.value]))},[o("i",{class:s(["fas",X.value])},null,2),P(" "+m(Q.value),1)],2),d.showFavoriteButton?(v(),i("button",{key:0,tabindex:"-1",class:s(["btn-favorite",{focused:"favorite"===T.value}]),onClick:t[3]||(t[3]=e=>H(d.items[E.value]))},[...t[4]||(t[4]=[o("i",{class:"fas fa-heart"},null,-1),P(" Add to Favorites ",-1)])],2)):u("",!0)])],2)])):u("",!0)];var a}),_:1})]),o("div",ca,[(v(!0),i(n,null,r(d.items,(e,a)=>(v(),i("button",{key:e.Id,tabindex:"-1",class:s(["indicator",{active:E.value===a}]),onClick:e=>(e=>{e>=0&&e<d.items.length&&(E.value=e,T.value="slider")})(a),"aria-label":`Go to slide ${a+1}`},null,10,da))),128))])],12,Je)]))}}),[["__scopeId","data-v-09fa30cf"]]),ma={class:"media-row","data-nav-zone":"media-row"},pa={class:"row-container","data-nav-container":"media-row"},ga={key:0,class:"loading-state"},fa=se(e({__name:"MediaRow",props:{items:{},loading:{type:Boolean},getImageUrl:{type:Function},loop:{type:Boolean}},emits:["itemClick","nearEnd"],setup(e,{emit:s}){const c=e,d=s,m=e=>"embyItem"in e&&"tmdbData"in e,p=e=>"Id"in e&&"Name"in e&&!("title"in e)&&!("name"in e),g=I(()=>c.loop&&0!==c.items.length?[...c.items,...c.items,...c.items]:c.items),y=a();let b=!1;const h=e=>{if(!y.value)return;const a=.8*y.value.clientWidth,t=y.value.scrollLeft+("right"===e?a:-a);y.value.scrollTo({left:t,behavior:"smooth"})},k=()=>{if(!y.value||b)return;const{scrollLeft:e,scrollWidth:a,clientWidth:t}=y.value;if(c.loop&&c.items.length>0){const t=a/3;e>=2*t?(b=!0,y.value.scrollLeft=e-t,setTimeout(()=>{b=!1},50)):e<=.1*t&&(b=!0,y.value.scrollLeft=e+t,setTimeout(()=>{b=!1},50))}else{(e+t)/a>=.7&&d("nearEnd")}},w=()=>{if(!y.value||c.loop)return;const{scrollWidth:e,clientWidth:a}=y.value;e<=a&&d("nearEnd")},S=()=>{if(y.value&&c.loop&&c.items.length>0){const e=y.value.scrollWidth/3;y.value.scrollLeft=e}};return f(()=>c.items,async()=>{await T(),setTimeout(w,100)},{immediate:!1}),t(()=>{y.value&&(y.value.addEventListener("scroll",k,{passive:!0}),setTimeout(S,100),setTimeout(w,150))}),l(()=>{y.value&&y.value.removeEventListener("scroll",k)}),(a,t)=>(v(),i("div",ma,[o("div",pa,[o("button",{class:"scroll-btn scroll-btn-left",tabindex:"-1",onClick:t[0]||(t[0]=e=>h("left")),"aria-label":"Scroll left"},[...t[2]||(t[2]=[o("i",{class:"fas fa-chevron-left"},null,-1)])]),o("div",{ref_key:"scrollContainer",ref:y,class:"row-content","data-nav-scrollable":"true"},[e.loading?(v(),i("div",ga,[(v(),i(n,null,r(6,e=>o("div",{key:e,class:"media-card-skeleton"})),64))])):u("",!0),(v(!0),i(n,null,r(g.value,(a,t)=>(v(),i(n,{key:`${m(a)?a.embyId:p(a)?a.Id:a.id}-${t}`},[m(a)?(v(),E(He,{key:0,item:a.embyItem,"image-url":e.getImageUrl(a.tmdbData)||void 0,"streaming-providers":a.streamingProviders,onClick:e=>d("itemClick",a.tmdbData)},null,8,["item","image-url","streaming-providers","onClick"])):p(a)?(v(),E(He,{key:1,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"])):(v(),E(He,{key:2,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"]))],64))),128))],512),o("button",{class:"scroll-btn scroll-btn-right",tabindex:"-1",onClick:t[1]||(t[1]=e=>h("right")),"aria-label":"Scroll right"},[...t[3]||(t[3]=[o("i",{class:"fas fa-chevron-right"},null,-1)])])])]))}}),[["__scopeId","data-v-c99390b6"]]),ya={class:"genre-filter","data-nav-zone":"genre-filter"},ba={class:"filter-container"},ha=["onClick","onKeydown","onFocus"],ka=se(e({__name:"GenreFilter",props:{genres:{},selectedGenres:{default:()=>[]},maxVisible:{default:8}},emits:["update:selectedGenres"],setup(e,{emit:t}){const l=e,u=t,c=a(),d=a([]),p=a(-1),g=e=>{const a=[...l.selectedGenres],t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e),u("update:selectedGenres",a)},f=()=>{u("update:selectedGenres",[])},y=I(()=>l.selectedGenres.length>0),b=e=>{if(!c.value||!d.value[e])return;const a=d.value[e],t=c.value,l=a.offsetLeft,i=l+a.offsetWidth,s=t.scrollLeft,o=t.clientWidth;l<s?t.scrollTo({left:l-20,behavior:"smooth"}):i>s+o&&t.scrollTo({left:i-o+20,behavior:"smooth"})},h=(e,a,t)=>{const i=l.genres.length+1;switch(e.key){case"ArrowLeft":0===a||(e.preventDefault(),e.stopPropagation(),p.value=a-1,T(()=>{d.value[p.value]?.focus(),b(p.value)}));break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),a<i-1&&(p.value=a+1,T(()=>{d.value[p.value]?.focus(),b(p.value)}));break;case"ArrowUp":case"ArrowDown":break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),0===a?f():void 0!==t&&g(t)}},k=e=>{p.value=e},w=(e,a)=>{e&&(d.value[a]=e)};return(a,t)=>(v(),i("div",ya,[o("div",ba,[o("div",{ref_key:"scrollContainer",ref:c,class:"genres-list"},[o("button",{ref:e=>w(e,0),class:s(["genre-pill",{active:!y.value}]),tabindex:"0",onClick:f,onKeydown:t[0]||(t[0]=e=>h(e,0)),onFocus:t[1]||(t[1]=e=>k(0))}," All ",34),(v(!0),i(n,null,r(e.genres,(e,a)=>{return v(),i("button",{key:e.id,ref_for:!0,ref:e=>w(e,a+1),class:s(["genre-pill",{active:(t=e.id,l.selectedGenres.includes(t))}]),tabindex:"0",onClick:a=>g(e.id),onKeydown:t=>h(t,a+1,e.id),onFocus:e=>k(a+1)},m(e.name),43,ha);var t}),128))],512)])]))}}),[["__scopeId","data-v-ef4ff9fc"]]),wa={class:"modal-container"},Ia={class:"modal-body"},Sa={key:0,class:"error-message"},Ca={class:"form-group"},xa=se(e({__name:"TmdbApiKeyModal",emits:["close","submit"],setup(e,{emit:t}){const l=t,s=a(""),n=a(""),r=()=>{console.log("[TmdbApiKeyModal] handleSubmit called with:",s.value),s.value.trim()?s.value.trim().length<32?n.value="API key appears to be invalid (too short)":(console.log("[TmdbApiKeyModal] Emitting submit event"),l("submit",s.value.trim())):n.value="Please enter a valid API key"},d=()=>{l("close")};return(e,a)=>(v(),i("div",{class:"modal-overlay",onClick:c(d,["self"])},[o("div",wa,[o("div",{class:"modal-header"},[a[2]||(a[2]=o("h2",null,"TMDB API Key Required",-1)),o("button",{class:"close-button",onClick:d},[...a[1]||(a[1]=[o("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[o("path",{d:"M18 6L6 18M6 6l12 12","stroke-width":"2","stroke-linecap":"round"})],-1)])])]),o("div",Ia,[a[6]||(a[6]=o("p",{class:"description"}," To display trending movies and TV shows, we need a TMDB (The Movie Database) API key. This service is free and provides rich media information. ",-1)),n.value?(v(),i("div",Sa,m(n.value),1)):u("",!0),o("form",{onSubmit:c(r,["prevent"])},[o("div",Ca,[a[3]||(a[3]=o("label",{for:"tmdb-api-key"},"API Key",-1)),y(o("input",{id:"tmdb-api-key","onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),type:"text",placeholder:"Enter your TMDB API key",autocomplete:"off",spellcheck:"false"},null,512),[[b,s.value]])]),a[5]||(a[5]=o("div",{class:"info-section"},[o("p",{class:"info-text"},[P(" Don't have an API key? "),o("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",class:"register-link"}," Register for free on TMDB ")]),o("p",{class:"info-text small"}," After registering, you can find your API key in your account settings under the API section. ")],-1)),o("div",{class:"button-group"},[o("button",{type:"button",class:"btn-secondary",onClick:d}," Skip for Now "),a[4]||(a[4]=o("button",{type:"submit",class:"btn-primary"}," Save API Key ",-1))])],32)])])]))}}),[["__scopeId","data-v-5a9c93db"]]),Ea={class:"details-hero"},_a={class:"hero-content"},Pa=["src","alt"],Ta={key:1,class:"hero-title"},La={class:"hero-actions"},Ma={class:"hero-meta"},Da={key:0,class:"meta-item"},Aa={key:1,class:"meta-item meta-rating-badge"},Ua={key:2,class:"meta-item"},Na={key:3,class:"meta-item meta-star-rating"},Ra={key:2,class:"hero-genres"},Fa={key:0},Va={key:3,class:"hero-overview"},Ka={class:"hero-extra-actions"},$a=["title"],Ba=se(e({__name:"MovieDetails",props:{item:{},imageUrl:{},backdropUrl:{},logoUrl:{}},emits:["play","back","browse","removeFromContinueWatching","markAsUnwatched"],setup(e,{emit:l}){const c=e,d=l,p=a(!1);t(()=>{const e=document.querySelector(".btn-hero-play");e&&e.focus()});const{formatRuntime:g,formatRating:y}=N(),b=I(()=>"BoxSet"===c.item.Type),h=I(()=>!0===c.item.UserData?.Played),k=()=>{console.log(`[MovieDetails] Logo failed to load for item: ${c.item.Name}`),p.value=!0};f(()=>[c.item.Id,c.logoUrl],()=>{p.value=!1});const w=()=>{const e=document.querySelector(".main-content");e&&e.scrollTo({top:0,behavior:"smooth"})},C=(e,a)=>{if(e.key.startsWith("Arrow"))switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowLeft":if("play"===a){const e=document.querySelector(".sidebar .nav-item");e&&e.focus()}else if("back"===a){const e=document.querySelector(".btn-hero-play");e?.focus()}else if("mark"===a){const e=document.querySelector(".btn-hero-secondary");e?.focus()}break;case"ArrowRight":if("play"===a){const e=document.querySelector(".btn-hero-secondary");e?.focus()}else if("back"===a){const e=document.querySelector(".btn-icon");e?.focus()}break;case"ArrowDown":const e=document.querySelector(".season-buttons button");e&&e.focus()}};return(a,t)=>(v(),i("div",Ea,[o("div",_a,[e.logoUrl&&!p.value?(v(),i("img",{key:0,src:e.logoUrl,alt:e.item.Name,class:"hero-logo",onError:k},null,40,Pa)):(v(),i("h1",Ta,m(e.item.Name),1)),o("div",La,[b.value?(v(),i("button",{key:1,class:"btn-hero-play",onClick:t[2]||(t[2]=a=>d("browse",e.item)),onKeydown:t[3]||(t[3]=e=>C(e,"play")),onFocus:w},[...t[9]||(t[9]=[o("i",{class:"fas fa-folder-open"},null,-1),P(" Browse Collection ",-1)])],32)):(v(),i("button",{key:0,class:"btn-hero-play",tabindex:"0",onClick:t[0]||(t[0]=a=>d("play",e.item)),onKeydown:t[1]||(t[1]=e=>C(e,"play")),onFocus:w},[...t[8]||(t[8]=[o("i",{class:"fas fa-play"},null,-1),P(" Play Now ",-1)])],32)),o("button",{class:"btn-hero-secondary",tabindex:"0",onClick:t[4]||(t[4]=e=>d("back")),onKeydown:t[5]||(t[5]=e=>C(e,"back")),onFocus:w},[...t[10]||(t[10]=[o("i",{class:"fas fa-info-circle"},null,-1),P(" More Information ",-1)])],32)]),o("div",Ma,[e.item.ProductionYear?(v(),i("span",Da,m(e.item.ProductionYear),1)):u("",!0),e.item.OfficialRating?(v(),i("span",Aa,m(e.item.OfficialRating),1)):u("",!0),e.item.RunTimeTicks?(v(),i("span",Ua,m(S(g)(e.item.RunTimeTicks)),1)):u("",!0),e.item.CommunityRating?(v(),i("span",Na,[t[11]||(t[11]=o("i",{class:"fas fa-star"},null,-1)),P(" "+m(S(y)(e.item.CommunityRating)),1)])):u("",!0)]),e.item.Genres&&e.item.Genres.length?(v(),i("div",Ra,[(v(!0),i(n,null,r(e.item.Genres.slice(0,3),(a,t)=>(v(),i("span",{key:a},[P(m(a),1),t<Math.min(e.item.Genres.length,3)-1?(v(),i("span",Fa," • ")):u("",!0)]))),128))])):u("",!0),e.item.Overview?(v(),i("p",Va,m(e.item.Overview),1)):u("",!0),o("div",Ka,[b.value?u("",!0):(v(),i("button",{key:0,class:"btn-hero-secondary",tabindex:"0",onClick:t[6]||(t[6]=a=>h.value?d("markAsUnwatched",e.item):d("removeFromContinueWatching",e.item)),onKeydown:t[7]||(t[7]=e=>C(e,"mark")),onFocus:w,title:h.value?"Mark as Unwatched":"Mark as Watched"},[P(m(h.value?"Mark as Unwatched":"Mark as Watched")+" ",1),o("i",{class:s(h.value?"fas fa-times":"fas fa-check")},null,2)],40,$a))])])]))}}),[["__scopeId","data-v-f5c393a4"]]),qa={class:"player-container"},Wa={key:0,class:"player-overlay"},Ga={class:"error-message"},Ha={key:1,class:"skip-intro-container"},Oa=["aria-label"],za={class:"player-info"},ja={class:"font-bold pl-[3px]"},Ya={class:"progress-bar-track"},Qa={class:"progress-time"},Xa={class:"player-buttons"},Ja=["aria-label","title"],Za=["aria-label"],et=["aria-label","title"],at={class:"volume-control"},tt=["value"],lt={class:"subtitle-menu-container"},it={key:0,class:"context-menu subtitle-menu"},st={key:0,class:"fas fa-check"},ot=["onClick","onKeydown"],nt={key:0,class:"fas fa-check"},rt={class:"quality-menu-container"},ut={key:0,class:"context-menu quality-menu"},ct=["onClick","onKeydown"],dt={key:0,class:"fas fa-check"},vt=["aria-label"],mt=se(e({__name:"VideoPlayer",props:{item:{},streamUrl:{}},emits:["close","progress","playbackStart","playbackStop","switchEpisode"],setup(e,{emit:c}){const d=e,f=M(),y=R(),b=c,h=a(null),k=I(()=>d.streamUrl),w=a(0),C=a(0),x=I(()=>0===C.value?0:w.value/C.value*100),E=a(!0);let _=null;const T=a(!1),L=a(1),D=a(!1),A=a(!1),U=a([]),N=a([]),V=a(null),K=a("Auto"),$=a(null),B=a(!1),q=a(null),W=a(!1),G=a("Skip Intro");let H=null;const O=a(null),z=a(null),j=I(()=>"Episode"===d.item.Type&&d.item.SeriesId),Y=e=>e/1e7,Q=e=>Math.floor(1e7*e),{isPlaying:X,errorMessage:J,handlePlayPause:Z,handleStop:ee,handleSeek:ae}=F(h,k,{onProgress:(e,a)=>{b("progress",e,a)},onPlaybackStart:()=>{b("playbackStart")},onPlaybackStop:e=>{b("playbackStop",e)}}),te=()=>{h.value&&(w.value=h.value.currentTime,C.value=h.value.duration||0,le())},le=()=>{if(!h.value)return B.value=!1,void(W.value=!1);const e=Q(w.value);if($.value){const{IntroStart:a,IntroEnd:t}=$.value;if(e>=a&&e<=t)return B.value=!0,W.value=!1,void(G.value="Skip Intro")}if(q.value){const{CreditsStart:a,CreditsEnd:t}=q.value;if(e>=a&&e<=t)return B.value=!1,W.value=!0,void(G.value="Skip Credits")}B.value=!1,W.value=!1},ie=()=>{if(h.value){if(B.value&&$.value){const e=Y($.value.IntroEnd);h.value.currentTime=e,B.value=!1,console.log("[VideoPlayer] Skipped intro to",e)}else if(W.value&&q.value){if(j.value&&O.value)return console.log("[VideoPlayer] Skipping credits and going to next episode:",O.value.Name),void oe();const e=Y(q.value.CreditsEnd);h.value.currentTime=e,W.value=!1,console.log("[VideoPlayer] Skipped credits to",e)}ue()}},se=()=>{z.value&&(console.log("[VideoPlayer] Navigating to previous episode:",z.value.Name),b("switchEpisode",z.value.Id))},oe=()=>{O.value&&(console.log("[VideoPlayer] Navigating to next episode:",O.value.Name),b("switchEpisode",O.value.Id))},ne=e=>{if(!isFinite(e))return"0:00";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},re=e=>{if(!h.value)return;const a=e.currentTarget.getBoundingClientRect(),t=(e.clientX-a.left)/a.width*C.value;h.value.currentTime=t,ue()},ue=()=>{E.value=!0,null!==_&&clearTimeout(_),_=window.setTimeout(()=>{E.value=!1},3e3)},ce=()=>{ue()},de=e=>{const a=e.target;a.closest(".subtitle-menu-container")||a.closest(".quality-menu-container")||(D.value=!1,A.value=!1)},ve=()=>{ee(),b("close")},me=async()=>{const e=document.querySelector(".player-container");if(e){try{document.fullscreenElement?(await document.exitFullscreen(),T.value=!1):(await e.requestFullscreen(),T.value=!0)}catch(a){console.error("[VideoPlayer] Fullscreen error:",a)}ue()}},pe=()=>{T.value=!!document.fullscreenElement},ge=e=>{const a=e.target,t=parseFloat(a.value);L.value=t,h.value&&(h.value.volume=t),ue()},fe=()=>{D.value=!D.value,D.value&&(A.value=!1),ue()},ye=()=>{A.value=!A.value,A.value&&(D.value=!1),ue()},be=e=>{if(V.value=e,!h.value)return;const a=h.value.textTracks;for(let t=0;t<a.length;t++)a[t].mode="disabled";null!==e&&a[e]&&(a[e].mode="showing"),D.value=!1,ue(),console.log("[VideoPlayer] Subtitle selected:",null===e?"Off":U.value[e]?.DisplayTitle)},he=e=>{K.value=e,A.value=!1,ue(),console.log("[VideoPlayer] Quality selected:",e)},ke=()=>{te(),setTimeout(()=>{console.log("[VideoPlayer] Starting credits detection after delay"),(async()=>{try{if(!h.value||!h.value.duration)return void console.log("[VideoPlayer] Video not ready for credits detection");const e=h.value.duration;if(d.streamUrl.includes("BigBuckBunny")||d.streamUrl.includes("commondatastorage")){const a=Math.max(0,e-30),t=e;return q.value={CreditsStart:Q(a),CreditsEnd:Q(t),confidence:1,detectionMethod:"manual"},void console.log("[VideoPlayer] Demo mode: Using simulated credits markers:",{start:a,end:t,duration:e})}const a=await y.getCreditsMarker(d.item.Id,d.item.SeriesId,null);if(a)return q.value=a,void console.log("[VideoPlayer] Credits markers loaded from cache:",{start:Y(a.CreditsStart),end:Y(a.CreditsEnd),confidence:a.confidence,method:a.detectionMethod});console.log("[VideoPlayer] Starting passive credits detection"),H=y.detectCreditsPassively(h.value,e=>{q.value=e,console.log("[VideoPlayer] Credits detected and saved:",{start:Y(e.CreditsStart),end:Y(e.CreditsEnd),confidence:e.confidence}),d.item.SeriesId&&y.saveCreditsToStorage(d.item.SeriesId,d.item.Id,e),H&&(H(),H=null)})}catch(e){console.error("[VideoPlayer] Failed to fetch credits markers:",e)}})()},5e3)};return t(()=>{h.value&&(h.value.addEventListener("timeupdate",te),h.value.addEventListener("loadedmetadata",ke),h.value.volume=L.value),document.addEventListener("mousemove",ce),document.addEventListener("focusin",ce),document.addEventListener("click",de),document.addEventListener("fullscreenchange",pe),ue(),(async()=>{try{const e=await f.getIntroSkipMarkers(d.item.Id);$.value=e,e&&console.log("[VideoPlayer] Intro markers loaded:",{start:Y(e.IntroStart),end:Y(e.IntroEnd)})}catch(e){console.error("[VideoPlayer] Failed to fetch intro markers:",e)}})(),(async()=>{if(j.value)try{const[e,a]=await Promise.all([f.getNextEpisode(d.item),f.getPreviousEpisode(d.item)]);O.value=e,z.value=a,console.log("[VideoPlayer] Adjacent episodes loaded:",{previous:a?.Name||"None",next:e?.Name||"None"})}catch(e){console.error("[VideoPlayer] Failed to fetch adjacent episodes:",e)}})(),(async()=>{try{const e=await f.getMediaSources(d.item.Id);if(e.length>0){const a=e[0];if(a.MediaStreams){U.value=a.MediaStreams.filter(e=>"Subtitle"===e.Type);const e=U.value.findIndex(e=>e.IsDefault);-1!==e&&(V.value=e),console.log("[VideoPlayer] Available subtitles:",U.value);const t=a.MediaStreams.filter(e=>"Video"===e.Type);if(t.length>0){const e=t[0],a=[{label:"Auto",bitrate:14e7}];e.Height&&(e.Height>=2160?(a.push({label:"4K",bitrate:12e7,height:2160}),a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=1080?(a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=720?(a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):a.push({label:"480p",bitrate:3e6,height:480})),N.value=a,console.log("[VideoPlayer] Available qualities:",N.value)}}}}catch(e){console.error("[VideoPlayer] Failed to fetch media info:",e)}})()}),l(()=>{h.value&&(h.value.removeEventListener("timeupdate",te),h.value.removeEventListener("loadedmetadata",ke)),document.removeEventListener("mousemove",ce),document.removeEventListener("focusin",ce),document.removeEventListener("click",de),document.removeEventListener("fullscreenchange",pe),null!==_&&clearTimeout(_),H&&(H(),H=null)}),(a,t)=>(v(),i("div",qa,[o("video",{ref_key:"videoElement",ref:h,class:"video-player",crossorigin:"anonymous"}," Your browser does not support the video tag. ",512),S(J)?(v(),i("div",Wa,[o("div",Ga," ⚠️ "+m(S(J)),1)])):u("",!0),B.value||W.value?(v(),i("div",Ha,[o("button",{type:"button",onClick:ie,onKeydown:p(ie,["enter"]),tabindex:"0",class:"skip-intro-btn","aria-label":G.value},[t[8]||(t[8]=o("i",{class:"fas fa-forward"},null,-1)),P(" "+m(G.value),1)],40,Oa)])):u("",!0),o("div",{class:s(["player-controls flex flex-col justify-between h-full",{"controls-hidden":!E.value}])},[o("div",za,[o("span",ja,m(e.item.SeriesName)+" Season "+m(e.item.ParentIndexNumber)+" Episode "+m(e.item.IndexNumber),1),o("h2",null,m(e.item.Name),1)]),o("div",null,[o("div",{class:"progress-bar-container",onClick:re},[o("div",Ya,[o("div",{class:"progress-bar-fill",style:g({width:x.value+"%"})},null,4)]),o("div",Qa,[o("span",null,m(ne(w.value)),1),o("span",null,m(ne(C.value)),1)])]),o("div",Xa,[j.value&&z.value?(v(),i("button",{key:0,type:"button",onClick:se,onKeydown:p(se,["enter"]),tabindex:"0",class:"control-btn","aria-label":`Previous episode: ${z.value.Name}`,title:`Previous: ${z.value.Name}`},[...t[9]||(t[9]=[o("i",{class:"fas fa-step-backward"},null,-1)])],40,Ja)):u("",!0),o("button",{type:"button",onClick:t[0]||(t[0]=e=>S(ae)(-10)),onKeydown:t[1]||(t[1]=p(e=>S(ae)(-10),["enter"])),tabindex:"0",class:"control-btn","aria-label":"Rewind 10 seconds"},[...t[10]||(t[10]=[o("i",{class:"fas fa-backward"},null,-1)])],32),o("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>S(Z)&&S(Z)(...e)),onKeydown:t[3]||(t[3]=p((...e)=>S(Z)&&S(Z)(...e),["enter"])),tabindex:"0",class:"control-btn control-btn-large","aria-label":S(X)?"Pause":"Play"},[o("i",{class:s(S(X)?"fas fa-pause":"fas fa-play")},null,2)],40,Za),o("button",{type:"button",onClick:t[4]||(t[4]=e=>S(ae)(10)),onKeydown:t[5]||(t[5]=p(e=>S(ae)(10),["enter"])),tabindex:"0",class:"control-btn","aria-label":"Forward 10 seconds"},[...t[11]||(t[11]=[o("i",{class:"fas fa-forward"},null,-1)])],32),j.value&&O.value?(v(),i("button",{key:1,type:"button",onClick:oe,onKeydown:p(oe,["enter"]),tabindex:"0",class:"control-btn","aria-label":`Next episode: ${O.value.Name}`,title:`Next: ${O.value.Name}`},[...t[12]||(t[12]=[o("i",{class:"fas fa-step-forward"},null,-1)])],40,et)):u("",!0),o("button",{type:"button",onClick:ve,onKeydown:p(ve,["enter"]),tabindex:"0",class:"control-btn","aria-label":"Stop"},[...t[13]||(t[13]=[o("i",{class:"fas fa-stop"},null,-1)])],32),o("div",at,[t[14]||(t[14]=o("i",{class:"fas fa-volume-up volume-icon"},null,-1)),o("input",{type:"range",min:"0",max:"1",step:"0.01",value:L.value,onInput:ge,class:"volume-slider","aria-label":"Volume"},null,40,tt)]),o("div",lt,[o("button",{type:"button",onClick:fe,onKeydown:p(fe,["enter"]),tabindex:"0",class:s(["control-btn",{active:null!==V.value}]),"aria-label":"Subtitles"},[...t[15]||(t[15]=[o("i",{class:"fas fa-closed-captioning"},null,-1)])],34),D.value?(v(),i("div",it,[t[17]||(t[17]=o("div",{class:"menu-header"},"Subtitles",-1)),o("button",{type:"button",onClick:t[6]||(t[6]=e=>be(null)),onKeydown:t[7]||(t[7]=p(e=>be(null),["enter"])),class:s(["menu-item",{active:null===V.value}])},[null===V.value?(v(),i("i",st)):u("",!0),t[16]||(t[16]=o("span",null,"Off",-1))],34),(v(!0),i(n,null,r(U.value,(e,a)=>(v(),i("button",{key:a,type:"button",onClick:e=>be(a),onKeydown:p(e=>be(a),["enter"]),class:s(["menu-item",{active:V.value===a}])},[V.value===a?(v(),i("i",nt)):u("",!0),o("span",null,m(e.DisplayTitle||e.Language||`Track ${a+1}`),1)],42,ot))),128))])):u("",!0)]),o("div",rt,[o("button",{type:"button",onClick:ye,onKeydown:p(ye,["enter"]),tabindex:"0",class:"control-btn","aria-label":"Quality"},[...t[18]||(t[18]=[o("i",{class:"fas fa-cog"},null,-1)])],32),A.value?(v(),i("div",ut,[t[19]||(t[19]=o("div",{class:"menu-header"},"Quality",-1)),(v(!0),i(n,null,r(N.value,e=>(v(),i("button",{key:e.label,type:"button",onClick:a=>he(e.label),onKeydown:p(a=>he(e.label),["enter"]),class:s(["menu-item",{active:K.value===e.label}])},[K.value===e.label?(v(),i("i",dt)):u("",!0),o("span",null,m(e.label),1)],42,ct))),128))])):u("",!0)]),o("button",{type:"button",onClick:me,onKeydown:p(me,["enter"]),tabindex:"0",class:"control-btn","aria-label":T.value?"Exit fullscreen":"Enter fullscreen"},[o("i",{class:s(T.value?"fas fa-compress":"fas fa-expand")},null,2)],40,vt)])])],2)]))}}),[["__scopeId","data-v-47638bb5"]]);export{$ as C,ka as G,va as H,he as L,fa as M,xa as T,mt as V,Ye as _,se as a,Ba as b,He as c,Le as d};
