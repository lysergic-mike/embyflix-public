import{d as e,r as a,o as t,a as l,c as i,n as s,b as o,F as n,e as r,f as c,w as u,u as d,g as v,t as m,h as p,i as g,j as f,v as b,k as y,l as h,m as k,p as w,q as S,s as I,x,T as C,y as E,z as P,A as _,B as T}from"./vue-vendor.C_Pyh8sQ.js";import{u as L,a as M,b as U,c as D,d as N,e as A,f as R,g as F}from"./composables.DFfBaK2Q.js";const V=""+new URL("EmbyFlix-logo.CCoAMb74.png",import.meta.url).href,$=440,q={MEDIA_CARD_SMALL:220,MEDIA_CARD_DEFAULT:300,MEDIA_CARD_LARGE:$,EPISODE_CARD:500,HERO_SLIDER:1920,BACKDROP_DEFAULT:1280,SIDEBAR_THUMB:154,DETAILS_POSTER:$},B={class:"sidebar w-[300px] transition-[width] duration-800"},G={class:"sidebar-nav","data-nav-container":"sidebar"},W=["onClick"],H={class:"nav-text"},z={class:"opacity-0 transition-opacity duration-300 group-focus-within:opacity-50 group-hover:opacity-50 focus-within:!opacity-100 hover:!opacity-100"},K={key:0,class:"continue-watching-container mt-8 mb-25"},O={class:"continue-watching-list",style:{"list-style":"none"}},j=["onClick"],Y={class:"absolute inset-0 overflow-hidden z-0 rounded-xl"},Q=["src","alt"],X={class:"flex flex-col justify-between z-1 relative h-40 w-full self-end px-4 pb-1 bg-gradient-to-t from-black/30 to-transparent group-focus/item:from-black/0"},J={class:"item-title-wrapper"},Z={class:"item-title font-bold text-white text-shadow"},ee={key:0,class:"bg-black bg-opacity-30"},ae={class:"bottom-row w-full"},te={class:"progress-details flex justify-between w-full items-center"},le={class:"flex bg-gray-600 bg-opacity-50 backdrop-blur-sm text-white px-2 rounded h-8 items-center justify-between gap-2"},ie={key:0},se=(e,a)=>{const t=e.__vccOpts||e;for(const[l,i]of a)t[l]=i;return t},oe=se(e({__name:"Sidebar",props:{activeNavItem:{},userName:{}},emits:["navigate","logout"],setup(e,{emit:g}){const f=g,b=d(),y=M(),h=L(),k=U(),w=a([]),S=[{id:"home",icon:"fas fa-home",text:"Home"},{id:"movies",icon:"fas fa-film",text:"Movies"},{id:"tvshows",icon:"fas fa-tv",text:"TV Shows"},{id:"collections",icon:"fas fa-folder",text:"Collections"},{id:"search",icon:"fas fa-search",text:"Search"},{id:"settings",icon:"fas fa-cog",text:"Settings"}],I=()=>{f("logout")},x=async()=>{if(y.isDemoMode.value)w.value=h.getContinueWatching();else try{const e=await k.getContinueWatching(),a=e.reduce((e,a)=>{const t=a.SeriesName||a.Name,l=a.ProductionYear;return e.some(e=>{const a=e.SeriesName||e.Name,i=e.ProductionYear;return a===t&&i===l})||e.push(a),e},[]);w.value=a,console.log("[Sidebar] Loaded continue watching items:",a.length,"unique items from",e.length,"total items")}catch(e){console.error("[Sidebar] Failed to load continue watching:",e)}},C=e=>y.isDemoMode.value?e.ImageUrl||"":k.getImageUrl(e.Id,"Primary",q.MEDIA_CARD_DEFAULT),E=e=>e.UserData?.PlaybackPositionTicks&&e.RunTimeTicks?Math.round(e.UserData.PlaybackPositionTicks/e.RunTimeTicks*100):0,P=e=>"Episode"===e.Type&&e.ParentIndexNumber&&e.IndexNumber?`S${e.ParentIndexNumber} E${e.IndexNumber}`:"",_=()=>{console.log("[Sidebar] Refreshing continue watching list"),x()},T=a(!1);return t(()=>{x(),window.addEventListener("refresh-continue-watching",_),setTimeout(()=>{T.value=!0},50)}),l(()=>{window.removeEventListener("refresh-continue-watching",_)}),(a,t)=>(v(),i("div",{class:s(["group sidebar-wrapper",{"enable-transition":T.value}]),"data-nav-zone":"sidebar"},[o("div",B,[o("nav",G,[(v(),i(n,null,r(S,a=>o("a",{key:a.id,href:"#",class:s(["nav-item",{active:e.activeNavItem===a.id}]),onClick:u(e=>f("navigate",a.id),["prevent"])},[o("i",{class:s(a.icon+" nav-icon")},null,2),o("span",H,m(a.text),1)],10,W)),64)),o("div",z,[w.value.length>0?(v(),i("div",K,[t[1]||(t[1]=o("h3",{class:"pl-2 mb-3 text-white font-semibold"},"Continue Watching",-1)),o("ul",O,[(v(!0),i(n,null,r(w.value,e=>(v(),i("li",{key:e.Id,class:"continue-watching-item relative overflow-hidden mb-3"},[o("div",{class:"item-wrapper bg-black min-h-45 rounded-xl relative flex cursor-pointer group/item",onClick:a=>(e=>{b.push({name:"Player",params:{itemId:e.Id}})})(e),tabindex:"0"},[o("div",Y,[o("img",{class:"w-full h-full object-cover",src:C(e),alt:e.SeriesName||e.Name,loading:"lazy",decoding:"async"},null,8,Q)]),o("div",X,[o("div",J,[o("span",Z,m(e.SeriesName||e.Name),1),E(e)?(v(),i("div",ee,[o("div",{class:"progress-bar bg-[#13ff00] h-1 mt-2 shadow-sm rounded-sm",style:p({width:E(e)+"%"})},null,4)])):c("",!0)]),o("div",ae,[o("div",te,[t[0]||(t[0]=o("span",{class:"btn-overlay bg-gray-600 bg-opacity-50 backdrop-blur-sm rounded-full w-8 h-8 flex justify-center items-center text-white"},[o("i",{class:"fas fa-play"})],-1)),o("div",le,[P(e)?(v(),i("span",ie,m(P(e)),1)):c("",!0),o("span",null,m(E(e))+"%",1)])])])])],8,j)]))),128))])])):c("",!0)]),o("a",{href:"#",class:"nav-item logout-item",onClick:u(I,["prevent"])},[...t[2]||(t[2]=[o("i",{class:"fas fa-sign-out-alt nav-icon"},null,-1),o("span",{class:"nav-text"},"Logout",-1)])])])])],2))}}),[["__scopeId","data-v-306fa94e"]]),ne={class:"search-container flex-1 flex items-center justify-end px-8"},re={class:"search-wrapper relative w-full max-w-125"},ce=se(e({__name:"Header",setup(e){const t=d(),l=y(),n=a(""),r=a(!1);g(()=>l.query.q,e=>{"Search"===l.name&&(n.value=e||"")},{immediate:!0}),g(n,e=>{"Search"===l.name&&e.trim()&&t.replace({name:"Search",query:{q:e.trim()}})});const c=e=>{"Enter"===e.key&&n.value.trim()&&t.push({name:"Search",query:{q:n.value.trim()}})},u=()=>{t.push({name:"Search"})};return(e,a)=>(v(),i("div",ne,[o("div",re,[o("i",{class:"fas fa-search search-icon absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer",onClick:u}),f(o("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),type:"text",placeholder:"Movies, series, shows...",class:s(["search-input w-full h-12 pl-12 pr-12 rounded-lg bg-gray-800/80 text-white border-none transition-all",{"bg-gray-700/90":r.value}]),onFocus:a[1]||(a[1]=e=>r.value=!0),onBlur:a[2]||(a[2]=e=>r.value=!1),onKeydown:c,onClick:u,tabindex:"0"},null,34),[[b,n.value]])])]))}}),[["__scopeId","data-v-b282c8dc"]]),ue={class:"layout"},de={key:0,class:"global-backdrop"},ve=["src"],me={class:"header"},pe={class:"content"},ge={class:"main-content px-7.5"},fe=se(e({__name:"BaseLayout",props:{activeNavItem:{},userName:{}},emits:["navigate","logout","search"],setup(e,{emit:s}){const n=s,r=a(""),u=e=>{n("search",e)},d=e=>{const a=e;r.value=a.detail||""};return t(()=>{const e=document.querySelector(".sidebar .nav-item");e&&e.focus(),window.addEventListener("update-backdrop",d)}),l(()=>{window.removeEventListener("update-backdrop",d)}),(a,t)=>(v(),i("div",ue,[r.value?(v(),i("div",de,[o("img",{src:r.value,alt:"Backdrop",class:"backdrop-image"},null,8,ve),t[2]||(t[2]=o("div",{class:"backdrop-gradient"},null,-1))])):c("",!0),o("div",me,[t[3]||(t[3]=o("div",{class:"logo-container w-75 h-full flex items-center b-bottom-1 border-primary-color border-1 pl-5"},[o("img",{src:V,alt:"EmbyFlix",class:"header-logo"})],-1)),h(ce,{onSearch:u})]),o("div",pe,[h(oe,{"active-nav-item":e.activeNavItem,"user-name":e.userName,onNavigate:t[0]||(t[0]=e=>n("navigate",e)),onLogout:t[1]||(t[1]=e=>n("logout"))},null,8,["active-nav-item","user-name"]),o("div",ge,[k(a.$slots,"default",{},void 0)])])]))}}),[["__scopeId","data-v-54501bb7"]]),be={key:0,class:"layout-wrapper"},ye={key:1,class:"no-layout-wrapper"},he=se(e({__name:"LayoutWrapper",setup(e){const t=y(),l=d(),s=M(),o=a("home"),n=w(()=>t.meta.layout||"none"),r=w(()=>"base"===n.value);g(()=>t.name,e=>{switch(e){case"Home":default:o.value="home";break;case"Search":o.value="search";break;case"Details":o.value="details"}},{immediate:!0});const c=e=>{switch(o.value=e,e){case"home":l.push({name:"Home"});break;case"search":l.push({name:"Search"});break;case"movies":case"tvshows":case"collections":case"settings":l.push({name:"Home"});const a=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(a);break;default:const t=new CustomEvent("sidebar-navigate",{detail:e});window.dispatchEvent(t)}},u=()=>{s.logout(),l.push({name:"Login"})},m=e=>{const a=new CustomEvent("app-search",{detail:e});window.dispatchEvent(a)};return(e,a)=>{const t=x("RouterView");return r.value?(v(),i("div",be,[h(fe,{"active-nav-item":o.value,"user-name":S(s).currentUser.value?.Name||"User",onNavigate:c,onLogout:u,onSearch:m},{default:I(()=>[h(t)]),_:1},8,["active-nav-item","user-name"])])):(v(),i("div",ye,[h(t)]))}}}),[["__scopeId","data-v-52626496"]]),ke={class:"login-container"},we={key:0,class:"error-message"},Se={class:"form-group"},Ie=["disabled"],xe={class:"form-group"},Ce=["disabled"],Ee={class:"form-group"},Pe=["disabled"],_e=["disabled"],Te=["disabled"],Le=e({__name:"LoginForm",props:{isLoading:{type:Boolean},error:{}},setup(e){const t=d(),l=M(),n=U(),r=a("http://localhost:8096"),u=a(""),p=a(""),g=a(""),y=async e=>{if(e&&e.preventDefault(),r.value&&u.value)try{const e=await n.authenticateByName(r.value,u.value,p.value);l.login(e.User),t.push({name:"Home"})}catch(a){g.value=a,console.error("Login failed:",a)}},h=()=>{l.enableDemoMode(),t.push({name:"Home"})};return(a,t)=>(v(),i("div",ke,[o("div",{class:s(["login-box",{"bg-red":g.value}])},[t[6]||(t[6]=o("div",{class:"logo-wrapper"},[o("img",{src:V,alt:"EmbyFlix",class:"login-logo"})],-1)),t[7]||(t[7]=o("p",null,"Connect to your Emby Server",-1)),g.value?(v(),i("div",we,m(g.value),1)):c("",!0),o("form",{onSubmit:y},[o("div",Se,[t[3]||(t[3]=o("label",{for:"server-url"},"Server URL",-1)),f(o("input",{id:"server-url","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"https://your-server:8096",disabled:e.isLoading},null,8,Ie),[[b,r.value]])]),o("div",xe,[t[4]||(t[4]=o("label",{for:"username"},"Username",-1)),f(o("input",{id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),type:"text",placeholder:"Enter username",disabled:e.isLoading},null,8,Ce),[[b,u.value]])]),o("div",Ee,[t[5]||(t[5]=o("label",{for:"password"},"Password",-1)),f(o("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),type:"password",placeholder:"Enter password",disabled:e.isLoading},null,8,Pe),[[b,p.value]])]),o("button",{type:"submit",class:"btn-primary",disabled:e.isLoading||!r.value||!u.value||!p.value||p.value.length<8},m(e.isLoading?"Connecting...":"Connect to Server"),9,_e),o("button",{type:"button",class:"btn-secondary",disabled:e.isLoading,onClick:h}," Demo Mode (Test UI) ",8,Te)],32)],2)]))}}),Me={class:"hero-slider-container"},Ue={key:0,class:"slider-section-title"},De=["data-slider-id"],Ne={class:"hero-slider"},Ae=["src","alt"],Re=["src","alt"],Fe={class:"slide-meta"},Ve={key:0,class:"meta-item"},$e={key:1,class:"meta-item rating"},qe={key:2,class:"meta-item"},Be={key:3,class:"meta-item"},Ge={key:2,class:"slide-genres"},We={key:3,class:"slide-description"},He={class:"slide-actions"},ze={class:"slider-indicators"},Ke=["onClick","aria-label"],Oe=se(e({__name:"HeroSlider",props:{items:{},getImageUrl:{},title:{},showFavoriteButton:{type:Boolean,default:!0},height:{default:"600px"},titleSize:{default:"3rem"},sliderId:{default:"hero"}},emits:["play","favorite","navigate"],setup(e,{emit:u}){const d=e,f=U(),b=L(),y=M(),k=D(f,b,y.isDemoMode),x=u,P=a(),_=a(0),T=a("slider"),A=a("slider"),R=a(new Map),F=a(new Map),V=a(new Set),$=()=>{_.value=(_.value+1)%d.items.length},q=e=>{if(P.value===document.activeElement)switch(e.key){case"Enter":e.preventDefault(),e.stopPropagation(),"slider"===T.value?K(d.items[_.value]):"play"===T.value?H(d.items[_.value]):"favorite"===T.value&&z(d.items[_.value]);break;case"ArrowLeft":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value)if(0===_.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"left"});window.dispatchEvent(e)}else _.value=(_.value-1+d.items.length)%d.items.length;else"play"===T.value?T.value="slider":"favorite"===T.value&&(T.value="play");break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),"slider"===T.value?$():"play"===T.value?d.showFavoriteButton?T.value="favorite":($(),T.value="slider"):"favorite"===T.value&&($(),T.value="slider");break;case"ArrowDown":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value)T.value="play";else if("play"===T.value||"favorite"===T.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"down"});window.dispatchEvent(e)}break;case"ArrowUp":if(e.preventDefault(),e.stopPropagation(),"slider"===T.value){const e=new CustomEvent(`exit${d.sliderId}Slider`,{detail:"up"});window.dispatchEvent(e)}else("play"===T.value||"favorite"===T.value)&&(T.value="slider")}},B=e=>{const a=e.relatedTarget;(!a||!P.value?.contains(a))&&(T.value=A.value)},G=()=>{A.value=T.value},W=e=>{const a=e.relatedTarget;(!a||!P.value?.contains(a))&&(T.value=A.value)};t(()=>{T.value="slider",P.value&&(P.value.addEventListener("keydown",q),P.value.addEventListener("focus",W,!0),P.value.addEventListener("focusin",B),P.value.addEventListener("focusout",G))}),l(()=>{P.value&&(P.value.removeEventListener("keydown",q),P.value.removeEventListener("focus",W,!0),P.value.removeEventListener("focusin",B),P.value.removeEventListener("focusout",G))});const H=e=>{x("play",e)},z=e=>{x("favorite",e)},K=e=>{x("navigate",e)},{formatRuntime:O}=N(),j=w(()=>d.items[_.value]),Y=w(()=>"Series"===j.value?.Type),Q=w(()=>Y.value?"Go to Show":"Play"),X=w(()=>Y.value?"fa-arrow-right":"fa-play"),J=async e=>await k.loadImageUrl(e,d.getImageUrl,d.items),Z=e=>V.value.has(e)?"":F.value.get(e)||"",ee=e=>{k.preloadImage(e)},ae=async()=>{const e=d.items[_.value];if(e){if(!R.value.has(e.Id)){const a=await J(e.Id);a&&R.value.set(e.Id,a)}if(!F.value.has(e.Id)){const a=(e=>{if(y.isDemoMode.value)return"";try{return f.getImageUrl(e,"Logo",500)}catch(a){return""}})(e.Id);a&&F.value.set(e.Id,a)}}(async()=>{const e=(_.value+1)%d.items.length,a=(_.value-1+d.items.length)%d.items.length,t=await J(d.items[e].Id);t&&(R.value.set(d.items[e].Id,t),ee(t));const l=await J(d.items[a].Id);l&&(R.value.set(d.items[a].Id,l),ee(l))})()};return g(()=>_.value,()=>{ae()},{immediate:!0}),g(()=>d.items,()=>{d.items.length>0&&ae()},{immediate:!0}),(a,t)=>(v(),i("div",Me,[d.title?(v(),i("h2",Ue,m(d.title),1)):c("",!0),o("div",{ref_key:"sliderWrapper",ref:P,class:"hero-slider-wrapper",tabindex:"0",style:p({height:d.height}),"data-slider-id":d.sliderId},[o("div",Ne,[h(C,{name:"slide-fade"},{default:I(()=>{return[d.items[_.value]?(v(),i("div",{key:d.items[_.value].Id,class:"hero-slide"},[o("div",{class:"slide-background",onClick:t[0]||(t[0]=e=>K(d.items[_.value]))},[o("img",{src:(a=d.items[_.value].Id,R.value.get(a)||""||d.items[_.value].ImageUrl),alt:d.items[_.value].Name,loading:"lazy",decoding:"async"},null,8,Ae)]),o("div",{class:s(["slide-content",{slim:"600px"!==e.height}])},[Z(d.items[_.value].Id)?(v(),i("img",{key:0,src:Z(d.items[_.value].Id),alt:d.items[_.value].Name,class:"slide-logo",onError:t[1]||(t[1]=e=>(e=>{console.log(`[HeroSlider] Logo failed to load for item: ${e}`),V.value.add(e),F.value.delete(e)})(d.items[_.value].Id))},null,40,Re)):(v(),i("h1",{key:1,class:"slide-title",style:p({fontSize:d.titleSize})},m(d.items[_.value].Name),5)),o("div",Fe,[d.items[_.value]?.ProductionYear?(v(),i("span",Ve,m(d.items[_.value]?.ProductionYear),1)):c("",!0),d.items[_.value]?.CommunityRating?(v(),i("span",$e," ⭐ "+m(d.items[_.value]?.CommunityRating?.toFixed(1)),1)):c("",!0),d.items[_.value]?.OfficialRating?(v(),i("span",qe,m(d.items[_.value]?.OfficialRating),1)):c("",!0),d.items[_.value]?.RunTimeTicks?(v(),i("span",Be,m(S(O)(d.items[_.value]?.RunTimeTicks)),1)):c("",!0)]),d.items[_.value]?.Genres?(v(),i("div",Ge,[(v(!0),i(n,null,r(d.items[_.value]?.Genres?.slice(0,3),e=>(v(),i("span",{key:e,class:"genre-tag"},m(e),1))),128))])):c("",!0),d.items[_.value]?.Overview?(v(),i("p",We,m(d.items[_.value]?.Overview?.substring(0,150))+"... ",1)):c("",!0),o("div",He,[o("button",{tabindex:"-1",class:s(["btn-play",{focused:"play"===T.value}]),onClick:t[2]||(t[2]=e=>H(d.items[_.value]))},[o("i",{class:s(["fas",X.value])},null,2),E(" "+m(Q.value),1)],2),d.showFavoriteButton?(v(),i("button",{key:0,tabindex:"-1",class:s(["btn-favorite",{focused:"favorite"===T.value}]),onClick:t[3]||(t[3]=e=>z(d.items[_.value]))},[...t[4]||(t[4]=[o("i",{class:"fas fa-heart"},null,-1),E(" Add to Favorites ",-1)])],2)):c("",!0)])],2)])):c("",!0)];var a}),_:1})]),o("div",ze,[(v(!0),i(n,null,r(d.items,(e,a)=>(v(),i("button",{key:e.Id,tabindex:"-1",class:s(["indicator",{active:_.value===a}]),onClick:e=>(e=>{e>=0&&e<d.items.length&&(_.value=e,T.value="slider")})(a),"aria-label":`Go to slide ${a+1}`},null,10,Ke))),128))])],12,De)]))}}),[["__scopeId","data-v-09fa30cf"]]),je={class:"card-image"},Ye=["src","alt"],Qe={key:1,class:"placeholder-image"},Xe={key:2,class:"placeholder-image"},Je={key:3,class:"watched-badge",title:"Watched"},Ze={key:4,class:"rating-badges"},ea=["title"],aa=["title"],ta={key:5,class:"streaming-providers"},la=["src","alt","title"],ia=["title"],sa={class:"card-info min-h-16"},oa={class:"card-title"},na={key:0,class:"card-year"},ra=se(e({__name:"MediaCard",props:{item:{},imageUrl:{},streamingProviders:{}},emits:["click"],setup(e,{emit:t}){const l=e,u=t,d=a(),p=a(!1);A(d,{threshold:.01,rootMargin:"200px",onEnter:()=>{p.value=!0}});const g=e=>"Id"in e&&"Name"in e,f=e=>"title"in e&&!("name"in e),b=e=>"name"in e&&"first_air_date"in e,y=w(()=>g(l.item)?l.item.Name:f(l.item)?l.item.title:b(l.item)?l.item.name:""),h=w(()=>(console.log("item::",l.item),g(l.item)?l.item.ProductionYear?.toString()||null:f(l.item)?l.item.release_date?new Date(l.item.release_date).getFullYear().toString():null:b(l.item)&&l.item.first_air_date?new Date(l.item.first_air_date).getFullYear().toString():null)),k=w(()=>l.imageUrl?l.imageUrl:g(l.item)?l.item.ImageUrl:null),S=w(()=>g(l.item)&&l.item.CommunityRating?{value:l.item.CommunityRating,display:`${(10*l.item.CommunityRating).toFixed(0)}%`}:!g(l.item)&&l.item.vote_average?{value:l.item.vote_average,display:`${(10*l.item.vote_average).toFixed(0)}%`}:null),I=w(()=>g(l.item)&&l.item.CriticRating?{value:l.item.CriticRating,display:`${l.item.CriticRating}%`}:null),x=w(()=>null!==S.value||null!==I.value),C=w(()=>!!g(l.item)&&!0===l.item.UserData?.Played),E=w(()=>{if(g(l.item)){if("Movie"===l.item.Type)return"movie";if("Series"===l.item.Type)return"tv"}else{if(f(l.item))return"movie";if(b(l.item))return"tv"}return null}),_=w(()=>l.streamingProviders?.slice(0,3)||[]);return(a,t)=>(v(),i("div",{ref_key:"cardRef",ref:d,class:"media-card",tabindex:"0",onClick:t[0]||(t[0]=a=>u("click",e.item)),onKeydown:t[1]||(t[1]=P(a=>u("click",e.item),["enter"]))},[o("div",je,[p.value&&k.value?(v(),i("img",{key:0,src:k.value,alt:y.value,loading:"lazy",decoding:"async"},null,8,Ye)):p.value?(v(),i("div",Xe,m(y.value),1)):(v(),i("div",Qe," Loading... ")),C.value?(v(),i("div",Je,[...t[2]||(t[2]=[o("span",null,"Watched",-1)])])):c("",!0),x.value?(v(),i("div",Ze,[S.value?(v(),i("div",{key:0,class:"rating-badge community",title:`Audience Score: ${S.value.display}`},[t[3]||(t[3]=o("i",{class:"fas fa-users"},null,-1)),o("span",null,m(S.value.display),1)],8,ea)):c("",!0),I.value?(v(),i("div",{key:1,class:"rating-badge critic",title:`Critics Score: ${I.value.display}`},[t[4]||(t[4]=o("i",{class:"fas fa-star"},null,-1)),o("span",null,m(I.value.display),1)],8,aa)):c("",!0)])):c("",!0),_.value.length>0?(v(),i("div",ta,[(v(!0),i(n,null,r(_.value,e=>{return v(),i("img",{key:e.provider_id,src:(a=e.logo_path,`https://image.tmdb.org/t/p/original${a}`),alt:e.provider_name,title:`Available on ${e.provider_name}`,class:"provider-logo"},null,8,la);var a}),128))])):c("",!0),E.value?(v(),i("div",{key:6,class:"media-type-icon",title:"movie"===E.value?"Movie":"TV Show"},[o("i",{class:s("movie"===E.value?"fas fa-film":"fas fa-tv")},null,2)],8,ia)):c("",!0)]),o("div",sa,[o("h3",oa,m(y.value),1),h.value?(v(),i("div",na,m(h.value),1)):c("",!0)])],544))}}),[["__scopeId","data-v-27f561d5"]]),ca={class:"media-row","data-nav-zone":"media-row"},ua={class:"row-container","data-nav-container":"media-row"},da={key:0,class:"loading-state"},va=se(e({__name:"MediaRow",props:{items:{},loading:{type:Boolean},getImageUrl:{type:Function},loop:{type:Boolean}},emits:["itemClick","nearEnd"],setup(e,{emit:s}){const u=e,d=s,m=e=>"embyItem"in e&&"tmdbData"in e,p=e=>"Id"in e&&"Name"in e&&!("title"in e)&&!("name"in e),f=w(()=>u.loop&&0!==u.items.length?[...u.items,...u.items,...u.items]:u.items),b=a();let y=!1;const h=e=>{if(!b.value)return;const a=.8*b.value.clientWidth,t=b.value.scrollLeft+("right"===e?a:-a);b.value.scrollTo({left:t,behavior:"smooth"})},k=()=>{if(!b.value||y)return;const{scrollLeft:e,scrollWidth:a,clientWidth:t}=b.value;if(u.loop&&u.items.length>0){const t=a/3;e>=2*t?(y=!0,b.value.scrollLeft=e-t,setTimeout(()=>{y=!1},50)):e<=.1*t&&(y=!0,b.value.scrollLeft=e+t,setTimeout(()=>{y=!1},50))}else{(e+t)/a>=.7&&d("nearEnd")}},S=()=>{if(!b.value||u.loop)return;const{scrollWidth:e,clientWidth:a}=b.value;e<=a&&d("nearEnd")},I=()=>{if(b.value&&u.loop&&u.items.length>0){const e=b.value.scrollWidth/3;b.value.scrollLeft=e}};return g(()=>u.items,async()=>{await T(),setTimeout(S,100)},{immediate:!1}),t(()=>{b.value&&(b.value.addEventListener("scroll",k,{passive:!0}),setTimeout(I,100),setTimeout(S,150))}),l(()=>{b.value&&b.value.removeEventListener("scroll",k)}),(a,t)=>(v(),i("div",ca,[o("div",ua,[o("button",{class:"scroll-btn scroll-btn-left",tabindex:"-1",onClick:t[0]||(t[0]=e=>h("left")),"aria-label":"Scroll left"},[...t[2]||(t[2]=[o("i",{class:"fas fa-chevron-left"},null,-1)])]),o("div",{ref_key:"scrollContainer",ref:b,class:"row-content","data-nav-scrollable":"true"},[e.loading?(v(),i("div",da,[(v(),i(n,null,r(6,e=>o("div",{key:e,class:"media-card-skeleton"})),64))])):c("",!0),(v(!0),i(n,null,r(f.value,(a,t)=>(v(),i(n,{key:`${m(a)?a.embyId:p(a)?a.Id:a.id}-${t}`},[m(a)?(v(),_(ra,{key:0,item:a.embyItem,"image-url":e.getImageUrl(a.tmdbData)||void 0,"streaming-providers":a.streamingProviders,onClick:e=>d("itemClick",a.tmdbData)},null,8,["item","image-url","streaming-providers","onClick"])):p(a)?(v(),_(ra,{key:1,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"])):(v(),_(ra,{key:2,item:a,"image-url":e.getImageUrl(a)||void 0,onClick:e=>d("itemClick",a)},null,8,["item","image-url","onClick"]))],64))),128))],512),o("button",{class:"scroll-btn scroll-btn-right",tabindex:"-1",onClick:t[1]||(t[1]=e=>h("right")),"aria-label":"Scroll right"},[...t[3]||(t[3]=[o("i",{class:"fas fa-chevron-right"},null,-1)])])])]))}}),[["__scopeId","data-v-c99390b6"]]),ma={class:"genre-filter","data-nav-zone":"genre-filter"},pa={class:"filter-container"},ga=["onClick","onKeydown","onFocus"],fa=se(e({__name:"GenreFilter",props:{genres:{},selectedGenres:{default:()=>[]},maxVisible:{default:8}},emits:["update:selectedGenres"],setup(e,{emit:t}){const l=e,c=t,u=a(),d=a([]),p=a(-1),g=e=>{const a=[...l.selectedGenres],t=a.indexOf(e);t>-1?a.splice(t,1):a.push(e),c("update:selectedGenres",a)},f=()=>{c("update:selectedGenres",[])},b=w(()=>l.selectedGenres.length>0),y=e=>{if(!u.value||!d.value[e])return;const a=d.value[e],t=u.value,l=a.offsetLeft,i=l+a.offsetWidth,s=t.scrollLeft,o=t.clientWidth;l<s?t.scrollTo({left:l-20,behavior:"smooth"}):i>s+o&&t.scrollTo({left:i-o+20,behavior:"smooth"})},h=(e,a,t)=>{const i=l.genres.length+1;switch(e.key){case"ArrowLeft":0===a||(e.preventDefault(),e.stopPropagation(),p.value=a-1,T(()=>{d.value[p.value]?.focus(),y(p.value)}));break;case"ArrowRight":e.preventDefault(),e.stopPropagation(),a<i-1&&(p.value=a+1,T(()=>{d.value[p.value]?.focus(),y(p.value)}));break;case"ArrowUp":case"ArrowDown":break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),0===a?f():void 0!==t&&g(t)}},k=e=>{p.value=e},S=(e,a)=>{e&&(d.value[a]=e)};return(a,t)=>(v(),i("div",ma,[o("div",pa,[o("div",{ref_key:"scrollContainer",ref:u,class:"genres-list"},[o("button",{ref:e=>S(e,0),class:s(["genre-pill",{active:!b.value}]),tabindex:"0",onClick:f,onKeydown:t[0]||(t[0]=e=>h(e,0)),onFocus:t[1]||(t[1]=e=>k(0))}," All ",34),(v(!0),i(n,null,r(e.genres,(e,a)=>{return v(),i("button",{key:e.id,ref_for:!0,ref:e=>S(e,a+1),class:s(["genre-pill",{active:(t=e.id,l.selectedGenres.includes(t))}]),tabindex:"0",onClick:a=>g(e.id),onKeydown:t=>h(t,a+1,e.id),onFocus:e=>k(a+1)},m(e.name),43,ga);var t}),128))],512)])]))}}),[["__scopeId","data-v-4ea3843b"]]),ba={class:"modal-container"},ya={class:"modal-body"},ha={key:0,class:"error-message"},ka={class:"form-group"},wa=se(e({__name:"TmdbApiKeyModal",emits:["close","submit"],setup(e,{emit:t}){const l=t,s=a(""),n=a(""),r=()=>{console.log("[TmdbApiKeyModal] handleSubmit called with:",s.value),s.value.trim()?s.value.trim().length<32?n.value="API key appears to be invalid (too short)":(console.log("[TmdbApiKeyModal] Emitting submit event"),l("submit",s.value.trim())):n.value="Please enter a valid API key"},d=()=>{l("close")};return(e,a)=>(v(),i("div",{class:"modal-overlay",onClick:u(d,["self"])},[o("div",ba,[o("div",{class:"modal-header"},[a[2]||(a[2]=o("h2",null,"TMDB API Key Required",-1)),o("button",{class:"close-button",onClick:d},[...a[1]||(a[1]=[o("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[o("path",{d:"M18 6L6 18M6 6l12 12","stroke-width":"2","stroke-linecap":"round"})],-1)])])]),o("div",ya,[a[6]||(a[6]=o("p",{class:"description"}," To display trending movies and TV shows, we need a TMDB (The Movie Database) API key. This service is free and provides rich media information. ",-1)),n.value?(v(),i("div",ha,m(n.value),1)):c("",!0),o("form",{onSubmit:u(r,["prevent"])},[o("div",ka,[a[3]||(a[3]=o("label",{for:"tmdb-api-key"},"API Key",-1)),f(o("input",{id:"tmdb-api-key","onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),type:"text",placeholder:"Enter your TMDB API key",autocomplete:"off",spellcheck:"false"},null,512),[[b,s.value]])]),a[5]||(a[5]=o("div",{class:"info-section"},[o("p",{class:"info-text"},[E(" Don't have an API key? "),o("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",class:"register-link"}," Register for free on TMDB ")]),o("p",{class:"info-text small"}," After registering, you can find your API key in your account settings under the API section. ")],-1)),o("div",{class:"button-group"},[o("button",{type:"button",class:"btn-secondary",onClick:d}," Skip for Now "),a[4]||(a[4]=o("button",{type:"submit",class:"btn-primary"}," Save API Key ",-1))])],32)])])]))}}),[["__scopeId","data-v-5a9c93db"]]),Sa={key:0,class:"movie-grid-container"},Ia={key:0,class:"grid-title"},xa={class:"grid",style:{position:"relative"},"data-nav-zone":"movie-grid"},Ca=e({__name:"MovieGrid",props:{items:{},title:{},getImageUrl:{type:Function}},emits:["itemClick"],setup(e,{emit:l}){const s=e,u=l,d=a(),g=a(0),f=a(600),b=w(()=>{if(!d.value)return 4;const e=d.value.clientWidth;return Math.max(1,Math.floor(e/196))}),y=w(()=>Math.ceil(f.value/336)+2),h=w(()=>Math.max(0,Math.floor(g.value/336)-1)),k=w(()=>{const e=h.value+y.value;return Math.min(Math.ceil(s.items.length/b.value),e)}),S=w(()=>{const e=h.value*b.value,a=k.value*b.value;return s.items.slice(e,a)}),I=w(()=>336*h.value),x=e=>{console.log("HandleScroll",e);const a=e.target;g.value=a.scrollTop,f.value=a.clientHeight};return t(()=>{d.value&&(f.value=d.value.clientHeight)}),(a,t)=>S.value?(v(),i("div",Sa,[e.title?(v(),i("h2",Ia,m(e.title),1)):c("",!0),o("div",{ref_key:"gridContainer",ref:d,class:"grid-wrapper",onScroll:x},[o("div",xa,[o("div",{style:p({transform:`translateY(${I.value}px)`})},[(v(!0),i(n,null,r(e.items,a=>(v(),_(ra,{key:a.Id,item:a,"image-url":e.getImageUrl?e.getImageUrl(a.Id):a.ImageUrl,onClick:e=>u("itemClick",a)},null,8,["item","image-url","onClick"]))),128))],4)])],544)])):c("",!0)}}),Ea={class:"details-hero"},Pa={class:"hero-content"},_a=["src","alt"],Ta={key:1,class:"hero-title"},La={class:"hero-actions"},Ma={class:"hero-meta"},Ua={key:0,class:"meta-item"},Da={key:1,class:"meta-item meta-rating-badge"},Na={key:2,class:"meta-item"},Aa={key:3,class:"meta-item meta-star-rating"},Ra={key:2,class:"hero-genres"},Fa={key:0},Va={key:3,class:"hero-overview"},$a={class:"hero-extra-actions"},qa=["title"],Ba=se(e({__name:"MovieDetails",props:{item:{},imageUrl:{},backdropUrl:{},logoUrl:{}},emits:["play","back","browse","removeFromContinueWatching","markAsUnwatched"],setup(e,{emit:l}){const u=e,d=l,p=a(!1);t(()=>{const e=document.querySelector(".btn-hero-play");e&&e.focus()});const{formatRuntime:f,formatRating:b}=N(),y=w(()=>"BoxSet"===u.item.Type),h=w(()=>!0===u.item.UserData?.Played),k=()=>{console.log(`[MovieDetails] Logo failed to load for item: ${u.item.Name}`),p.value=!0};g(()=>[u.item.Id,u.logoUrl],()=>{p.value=!1});const I=()=>{const e=document.querySelector(".main-content");e&&e.scrollTo({top:0,behavior:"smooth"})},x=(e,a)=>{if(e.key.startsWith("Arrow"))switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowLeft":if("play"===a){const e=document.querySelector(".sidebar .nav-item");e&&e.focus()}else if("back"===a){const e=document.querySelector(".btn-hero-play");e?.focus()}else if("mark"===a){const e=document.querySelector(".sidebar .nav-item");e&&e.focus()}break;case"ArrowRight":if("play"===a){const e=document.querySelector(".btn-hero-secondary");e?.focus()}else if("back"===a){const e=document.querySelector(".hero-extra-actions .btn-hero-secondary");e?.focus()}break;case"ArrowDown":if("play"===a||"back"===a){const e=document.querySelector(".hero-extra-actions .btn-hero-secondary");if(e)e.focus();else{const e=document.querySelector(".season-buttons button"),a=document.querySelector(".similar-titles .media-card");e?e.focus():a&&a.focus()}}else if("mark"===a){const e=document.querySelector(".season-buttons button"),a=document.querySelector(".similar-titles .media-card");e?e.focus():a&&a.focus()}break;case"ArrowUp":if("mark"===a){const e=document.querySelector(".btn-hero-play");e?.focus()}}};return(a,t)=>(v(),i("div",Ea,[o("div",Pa,[e.logoUrl&&!p.value?(v(),i("img",{key:0,src:e.logoUrl,alt:e.item.Name,class:"hero-logo",onError:k},null,40,_a)):(v(),i("h1",Ta,m(e.item.Name),1)),o("div",La,[y.value?(v(),i("button",{key:1,class:"btn-hero-play",onClick:t[2]||(t[2]=a=>d("browse",e.item)),onKeydown:t[3]||(t[3]=e=>x(e,"play")),onFocus:I},[...t[9]||(t[9]=[o("i",{class:"fas fa-folder-open"},null,-1),E(" Browse Collection ",-1)])],32)):(v(),i("button",{key:0,class:"btn-hero-play",tabindex:"0",onClick:t[0]||(t[0]=a=>d("play",e.item)),onKeydown:t[1]||(t[1]=e=>x(e,"play")),onFocus:I},[...t[8]||(t[8]=[o("i",{class:"fas fa-play"},null,-1),E(" Play Now ",-1)])],32)),o("button",{class:"btn-hero-secondary",tabindex:"0",onClick:t[4]||(t[4]=e=>d("back")),onKeydown:t[5]||(t[5]=e=>x(e,"back")),onFocus:I},[...t[10]||(t[10]=[o("i",{class:"fas fa-info-circle"},null,-1),E(" More Information ",-1)])],32)]),o("div",Ma,[e.item.ProductionYear?(v(),i("span",Ua,m(e.item.ProductionYear),1)):c("",!0),e.item.OfficialRating?(v(),i("span",Da,m(e.item.OfficialRating),1)):c("",!0),e.item.RunTimeTicks?(v(),i("span",Na,m(S(f)(e.item.RunTimeTicks)),1)):c("",!0),e.item.CommunityRating?(v(),i("span",Aa,[t[11]||(t[11]=o("i",{class:"fas fa-star"},null,-1)),E(" "+m(S(b)(e.item.CommunityRating)),1)])):c("",!0)]),e.item.Genres&&e.item.Genres.length?(v(),i("div",Ra,[(v(!0),i(n,null,r(e.item.Genres.slice(0,3),(a,t)=>(v(),i("span",{key:a},[E(m(a),1),t<Math.min(e.item.Genres.length,3)-1?(v(),i("span",Fa," • ")):c("",!0)]))),128))])):c("",!0),e.item.Overview?(v(),i("p",Va,m(e.item.Overview),1)):c("",!0),o("div",$a,[y.value?c("",!0):(v(),i("button",{key:0,class:"btn-hero-secondary",tabindex:"0",onClick:t[6]||(t[6]=a=>h.value?d("markAsUnwatched",e.item):d("removeFromContinueWatching",e.item)),onKeydown:t[7]||(t[7]=e=>x(e,"mark")),onFocus:I,title:h.value?"Mark as Unwatched":"Mark as Watched"},[E(m(h.value?"Mark as Unwatched":"Mark as Watched")+" ",1),o("i",{class:s(h.value?"fas fa-times":"fas fa-check")},null,2)],40,qa))])])]))}}),[["__scopeId","data-v-d2ca501c"]]),Ga={class:"player-container"},Wa={key:0,class:"player-overlay"},Ha={class:"error-message"},za={key:1,class:"skip-intro-container","data-nav-zone":"skip-controls"},Ka=["aria-label"],Oa={key:2,class:"media-sidebar","data-nav-zone":"media-sidebar"},ja={class:"media-card-player"},Ya={class:"media-poster"},Qa=["src","alt"],Xa={class:"media-info"},Ja={key:0,class:"show-logo-container"},Za=["src","alt"],et={key:1,class:"show-title"},at={class:"show-genres"},tt={key:0},lt={class:"show-description"},it={class:"up-next-section"},st={class:"up-next-list"},ot=["aria-label"],nt={class:"up-next-thumbnail"},rt=["src","alt"],ct={class:"up-next-details"},ut={class:"up-next-episode"},dt={class:"top-bar"},vt={class:"top-bar-info"},mt={class:"episode-label"},pt={class:"episode-title"},gt={class:"top-bar-actions"},ft={class:"volume-menu-container"},bt={key:0,class:"context-menu volume-menu"},yt={class:"volume-slider-container"},ht=["value"],kt={class:"volume-percentage"},wt={class:"bottom-controls"},St={class:"control-buttons-row"},It={class:"subtitle-menu-container"},xt={key:0,class:"context-menu subtitle-menu"},Ct={key:0,class:"fas fa-check"},Et=["onClick"],Pt={key:0,class:"fas fa-check"},_t={class:"quality-menu-container"},Tt={key:0,class:"context-menu quality-menu"},Lt=["onClick"],Mt={key:0,class:"fas fa-check"},Ut=["aria-label"],Dt={class:"progress-bar-track"},Nt={class:"time-display"},At={class:"time-current"},Rt={class:"time-remaining"},Ft={class:"timezone-time"},Vt={class:"playback-buttons","data-nav-zone":"player-controls"},$t=["aria-label","title"],qt=["aria-label"],Bt=["aria-label","title"],Gt=se(e({__name:"VideoPlayer",props:{item:{},streamUrl:{}},emits:["close","progress","playbackStart","playbackStop","switchEpisode"],setup(e,{emit:u}){const d=e,g=U(),f=R(),b=u,y=a(null),h=w(()=>d.streamUrl),k=a(0),I=a(0),x=w(()=>0===I.value?0:k.value/I.value*100),C=a(!0);let P=null;const _=a(!1),T=a(1),L=a(!1),M=a(!1),D=a(!1),N=a([]),A=a([]),V=a(null),$=a("Auto"),q=a(null),B=a(!1),G=a(null),W=a(!1),H=a("Skip Intro");let z=null;const K=a(null),O=a(null),j=w(()=>"Episode"===d.item.Type&&d.item.SeriesId),Y=e=>e/1e7,Q=e=>Math.floor(1e7*e),{isPlaying:X,errorMessage:J,handlePlayPause:Z,handleStop:ee,handleSeek:ae}=F(y,h,{onProgress:(e,a)=>{b("progress",e,a)},onPlaybackStart:()=>{b("playbackStart")},onPlaybackStop:e=>{b("playbackStop",e)}}),te=()=>{y.value&&(k.value=y.value.currentTime,I.value=y.value.duration||0,le())},le=()=>{if(!y.value)return B.value=!1,void(W.value=!1);const e=Q(k.value);if(q.value){const{IntroStart:a,IntroEnd:t}=q.value;if(e>=a&&e<=t)return B.value=!0,W.value=!1,void(H.value="Skip Intro")}if(G.value){const{CreditsStart:a,CreditsEnd:t}=G.value;if(e>=a&&e<=t)return B.value=!1,W.value=!0,void(H.value="Skip Credits")}B.value=!1,W.value=!1},ie=()=>{if(y.value){if(B.value&&q.value){const e=Y(q.value.IntroEnd);y.value.currentTime=e,B.value=!1,console.log("[VideoPlayer] Skipped intro to",e)}else if(W.value&&G.value){if(j.value&&K.value)return console.log("[VideoPlayer] Skipping credits and going to next episode:",K.value.Name),void oe();const e=Y(G.value.CreditsEnd);y.value.currentTime=e,W.value=!1,console.log("[VideoPlayer] Skipped credits to",e)}pe()}},se=()=>{O.value&&(console.log("[VideoPlayer] Navigating to previous episode:",O.value.Name),b("switchEpisode",O.value.Id))},oe=()=>{K.value&&(console.log("[VideoPlayer] Navigating to next episode:",K.value.Name),b("switchEpisode",K.value.Id))},ne=e=>{if(!isFinite(e))return"0:00";const a=Math.floor(e/3600),t=Math.floor(e%3600/60),l=Math.floor(e%60);return a>0?`${a}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`},re=e=>{if(!e)return"";const a=e.ImageTags?.Primary||e.SeriesPrimaryImageTag,t=e.ImageTags?.Primary?e.Id:e.SeriesId||e.Id;return a&&g.serverUrl.value?`${g.serverUrl.value}/emby/Items/${t}/Images/Primary?tag=${a}&maxWidth=400`:""},ce=a(!1),ue=e=>e&&g.serverUrl.value?ce.value?"":e.SeriesId?g.getImageUrl(e.SeriesId,"Logo",500):g.getImageUrl(e.Id,"Logo",500):"",de=()=>{console.log("[VideoPlayer] Logo not available, showing title instead"),ce.value=!0},ve=()=>{if(!y.value)return"";const e=new Date,a=new Date(e),t=new Date(e.getTime()+1e3*(I.value-k.value)),l=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`;return`${l(a)} - ${l(t)}`},me=e=>{if(!y.value)return;const a=e.currentTarget.getBoundingClientRect(),t=(e.clientX-a.left)/a.width*I.value;y.value.currentTime=t,pe()},pe=()=>{C.value=!0,null!==P&&clearTimeout(P),P=window.setTimeout(()=>{C.value=!1},3e3)},ge=()=>{pe()},fe=e=>{const a=e.target;a.closest(".subtitle-menu-container")||a.closest(".quality-menu-container")||a.closest(".volume-menu-container")||(M.value=!1,D.value=!1,L.value=!1)},be=()=>{ee(),b("close")},ye=async()=>{const e=document.querySelector(".player-container");if(e){try{document.fullscreenElement?(await document.exitFullscreen(),_.value=!1):(await e.requestFullscreen(),_.value=!0)}catch(a){console.error("[VideoPlayer] Fullscreen error:",a)}pe()}},he=()=>{_.value=!!document.fullscreenElement},ke=e=>{const a=e.target,t=parseFloat(a.value);T.value=t,y.value&&(y.value.volume=t),pe()},we=()=>{L.value=!L.value,L.value&&(M.value=!1,D.value=!1),pe()},Se=()=>{M.value=!M.value,M.value&&(D.value=!1,L.value=!1),pe()},Ie=()=>{D.value=!D.value,D.value&&(M.value=!1,L.value=!1),pe()},xe=e=>{if(V.value=e,!y.value)return;const a=y.value.textTracks;for(let t=0;t<a.length;t++)a[t].mode="disabled";null!==e&&a[e]&&(a[e].mode="showing"),M.value=!1,pe(),console.log("[VideoPlayer] Subtitle selected:",null===e?"Off":N.value[e]?.DisplayTitle)},Ce=()=>{te(),setTimeout(()=>{console.log("[VideoPlayer] Starting credits detection after delay"),(async()=>{try{if(!y.value||!y.value.duration)return void console.log("[VideoPlayer] Video not ready for credits detection");const e=y.value.duration;if(d.streamUrl.includes("BigBuckBunny")||d.streamUrl.includes("commondatastorage")){const a=Math.max(0,e-30),t=e;return G.value={CreditsStart:Q(a),CreditsEnd:Q(t),confidence:1,detectionMethod:"manual"},void console.log("[VideoPlayer] Demo mode: Using simulated credits markers:",{start:a,end:t,duration:e})}const a=await f.getCreditsMarker(d.item.Id,d.item.SeriesId,null);if(a)return G.value=a,void console.log("[VideoPlayer] Credits markers loaded from cache:",{start:Y(a.CreditsStart),end:Y(a.CreditsEnd),confidence:a.confidence,method:a.detectionMethod});console.log("[VideoPlayer] Starting passive credits detection"),z=f.detectCreditsPassively(y.value,e=>{G.value=e,console.log("[VideoPlayer] Credits detected and saved:",{start:Y(e.CreditsStart),end:Y(e.CreditsEnd),confidence:e.confidence}),d.item.SeriesId&&f.saveCreditsToStorage(d.item.SeriesId,d.item.Id,e),z&&(z(),z=null)})}catch(e){console.error("[VideoPlayer] Failed to fetch credits markers:",e)}})()},5e3)};return t(()=>{y.value&&(y.value.addEventListener("timeupdate",te),y.value.addEventListener("loadedmetadata",Ce),y.value.volume=T.value),document.addEventListener("mousemove",ge),document.addEventListener("focusin",ge),document.addEventListener("click",fe),document.addEventListener("fullscreenchange",he),pe(),(async()=>{try{const e=await g.getIntroSkipMarkers(d.item.Id);q.value=e,e&&console.log("[VideoPlayer] Intro markers loaded:",{start:Y(e.IntroStart),end:Y(e.IntroEnd)})}catch(e){console.error("[VideoPlayer] Failed to fetch intro markers:",e)}})(),(async()=>{if(j.value)try{const[e,a]=await Promise.all([g.getNextEpisode(d.item),g.getPreviousEpisode(d.item)]);K.value=e,O.value=a,console.log("[VideoPlayer] Adjacent episodes loaded:",{previous:a?.Name||"None",next:e?.Name||"None"})}catch(e){console.error("[VideoPlayer] Failed to fetch adjacent episodes:",e)}})(),(async()=>{try{const e=await g.getMediaSources(d.item.Id);if(e.length>0){const a=e[0];if(a.MediaStreams){N.value=a.MediaStreams.filter(e=>"Subtitle"===e.Type);const e=N.value.findIndex(e=>e.IsDefault);-1!==e&&(V.value=e),console.log("[VideoPlayer] Available subtitles:",N.value);const t=a.MediaStreams.filter(e=>"Video"===e.Type);if(t.length>0){const e=t[0],a=[{label:"Auto",bitrate:14e7}];e.Height&&(e.Height>=2160?(a.push({label:"4K",bitrate:12e7,height:2160}),a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=1080?(a.push({label:"1080p",bitrate:4e7,height:1080}),a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):e.Height>=720?(a.push({label:"720p",bitrate:1e7,height:720}),a.push({label:"480p",bitrate:3e6,height:480})):a.push({label:"480p",bitrate:3e6,height:480})),A.value=a,console.log("[VideoPlayer] Available qualities:",A.value)}}}}catch(e){console.error("[VideoPlayer] Failed to fetch media info:",e)}})(),setTimeout(()=>{const e=document.querySelector(".control-btn-large");e&&e.focus()},100)}),l(()=>{y.value&&(y.value.removeEventListener("timeupdate",te),y.value.removeEventListener("loadedmetadata",Ce)),document.removeEventListener("mousemove",ge),document.removeEventListener("focusin",ge),document.removeEventListener("click",fe),document.removeEventListener("fullscreenchange",he),null!==P&&clearTimeout(P),z&&(z(),z=null)}),(a,t)=>(v(),i("div",Ga,[o("video",{ref_key:"videoElement",ref:y,class:"video-player",crossorigin:"anonymous"}," Your browser does not support the video tag. ",512),o("div",{class:s(["controls-gradient-backdrop",{"controls-hidden":!C.value}])},null,2),S(J)?(v(),i("div",Wa,[o("div",Ha," ⚠️ "+m(S(J)),1)])):c("",!0),B.value||W.value?(v(),i("div",za,[o("button",{type:"button",onClick:ie,tabindex:"0",class:"skip-intro-btn player-control-btn","aria-label":H.value},[t[4]||(t[4]=o("i",{class:"fas fa-forward"},null,-1)),E(" "+m(H.value),1)],8,Ka)])):c("",!0),S(X)?c("",!0):(v(),i("div",Oa,[o("div",ja,[o("div",Ya,[o("img",{src:re(e.item),alt:e.item.Name},null,8,Qa)]),o("div",Xa,[ue(e.item)&&!ce.value?(v(),i("div",Ja,[o("img",{src:ue(e.item),alt:e.item.SeriesName||e.item.Name,class:"show-logo",onError:de},null,40,Za)])):(v(),i("h2",et,m(e.item.SeriesName||e.item.Name),1)),o("div",at,[e.item.Genres&&e.item.Genres.length?(v(),i("span",tt,m(e.item.Genres.join(" • ")),1)):c("",!0)]),o("p",lt,m(e.item.Overview||"No description available."),1)]),o("div",it,[t[8]||(t[8]=o("h3",{class:"up-next-title"},"UP NEXT",-1)),o("div",st,[(v(),i(n,null,r(2,a=>o("div",{key:a,class:"up-next-item",tabindex:"0",role:"button","aria-label":`Episode ${a+6}`},[o("div",nt,[o("img",{src:re(e.item),alt:`Episode ${a+6}`},null,8,rt)]),o("div",ct,[t[5]||(t[5]=o("span",{class:"up-next-duration"},"20:18 - 20:48",-1)),o("span",ut,"Episode "+m(a+6),1),t[6]||(t[6]=o("h4",{class:"up-next-episode-title"},"Episode Title Goes Here",-1)),t[7]||(t[7]=o("button",{class:"add-watchlist-btn","aria-label":"Add to watchlist"},[o("i",{class:"fas fa-plus"}),E(" Add to watchlist ")],-1))])],8,ot)),64))])])])])),o("div",{class:s(["player-controls",{"controls-hidden":!C.value}])},[o("div",dt,[o("button",{type:"button",onClick:be,class:"back-btn player-control-btn","aria-label":"Back"},[...t[9]||(t[9]=[o("i",{class:"fas fa-arrow-left"},null,-1)])]),o("div",vt,[o("span",mt,m(e.item.SeriesName)+" Season "+m(e.item.ParentIndexNumber)+" Episode "+m(e.item.IndexNumber),1),o("h2",pt,m(e.item.Name),1)]),o("div",gt,[o("div",ft,[o("button",{type:"button",onClick:we,tabindex:"0",class:"icon-btn player-control-btn","aria-label":"Volume"},[o("i",{class:s(0===T.value?"fas fa-volume-mute":T.value<.5?"fas fa-volume-down":"fas fa-volume-up")},null,2)]),L.value?(v(),i("div",bt,[t[12]||(t[12]=o("div",{class:"menu-header"},"Volume",-1)),o("div",yt,[t[10]||(t[10]=o("i",{class:"fas fa-volume-up volume-icon-small"},null,-1)),o("input",{type:"range",min:"0",max:"1",step:"0.01",value:T.value,onInput:ke,class:"volume-slider-vertical","aria-label":"Volume slider"},null,40,ht),t[11]||(t[11]=o("i",{class:"fas fa-volume-down volume-icon-small"},null,-1))]),o("div",kt,m(Math.round(100*T.value))+"%",1)])):c("",!0)]),t[13]||(t[13]=o("button",{type:"button",class:"icon-btn player-control-btn","aria-label":"Cast"},[o("i",{class:"fas fa-cast"})],-1))])]),o("div",wt,[o("div",St,[o("div",It,[o("button",{type:"button",onClick:Se,tabindex:"0",class:s(["icon-btn player-control-btn",{active:null!==V.value}]),"aria-label":"Subtitles"},[...t[14]||(t[14]=[o("i",{class:"fas fa-closed-captioning"},null,-1)])],2),M.value?(v(),i("div",xt,[t[16]||(t[16]=o("div",{class:"menu-header"},"Subtitles",-1)),o("button",{type:"button",onClick:t[0]||(t[0]=e=>xe(null)),class:s(["menu-item",{active:null===V.value}])},[null===V.value?(v(),i("i",Ct)):c("",!0),t[15]||(t[15]=o("span",null,"Off",-1))],2),(v(!0),i(n,null,r(N.value,(e,a)=>(v(),i("button",{key:a,type:"button",onClick:e=>xe(a),class:s(["menu-item",{active:V.value===a}])},[V.value===a?(v(),i("i",Pt)):c("",!0),o("span",null,m(e.DisplayTitle||e.Language||`Track ${a+1}`),1)],10,Et))),128))])):c("",!0)]),o("div",_t,[o("button",{type:"button",onClick:Ie,tabindex:"0",class:"icon-btn player-control-btn","aria-label":"Quality"},[...t[17]||(t[17]=[o("i",{class:"fas fa-cog"},null,-1)])]),D.value?(v(),i("div",Tt,[t[18]||(t[18]=o("div",{class:"menu-header"},"Quality",-1)),(v(!0),i(n,null,r(A.value,e=>(v(),i("button",{key:e.label,type:"button",onClick:a=>(e=>{$.value=e,D.value=!1,pe(),console.log("[VideoPlayer] Quality selected:",e)})(e.label),class:s(["menu-item",{active:$.value===e.label}])},[$.value===e.label?(v(),i("i",Mt)):c("",!0),o("span",null,m(e.label),1)],10,Lt))),128))])):c("",!0)]),o("button",{type:"button",onClick:ye,tabindex:"0",class:"icon-btn player-control-btn","aria-label":_.value?"Exit fullscreen":"Enter fullscreen"},[o("i",{class:s(_.value?"fas fa-compress":"fas fa-expand")},null,2)],8,Ut)]),o("div",{class:"progress-bar-container",onClick:me},[o("div",Dt,[o("div",{class:"progress-bar-fill",style:p({width:x.value+"%"})},null,4)])]),o("div",Nt,[o("span",At,m(ne(k.value)),1),o("span",Rt,m(ne(I.value)),1)]),o("div",Ft,m(ve()),1),o("div",Vt,[j.value&&O.value?(v(),i("button",{key:0,type:"button",onClick:se,tabindex:"0",class:"control-btn player-control-btn","aria-label":`Previous episode: ${O.value.Name}`,title:`Previous: ${O.value.Name}`},[...t[19]||(t[19]=[o("i",{class:"fas fa-step-backward"},null,-1)])],8,$t)):c("",!0),o("button",{type:"button",onClick:t[1]||(t[1]=e=>S(ae)(-10)),tabindex:"0",class:"control-btn player-control-btn","aria-label":"Rewind 10 seconds"},[...t[20]||(t[20]=[o("i",{class:"fas fa-backward"},null,-1)])]),o("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>S(Z)&&S(Z)(...e)),tabindex:"0",class:"control-btn control-btn-large player-control-btn","aria-label":S(X)?"Pause":"Play"},[o("i",{class:s(S(X)?"fas fa-pause":"fas fa-play")},null,2)],8,qt),o("button",{type:"button",onClick:t[3]||(t[3]=e=>S(ae)(10)),tabindex:"0",class:"control-btn player-control-btn","aria-label":"Forward 10 seconds"},[...t[21]||(t[21]=[o("i",{class:"fas fa-forward"},null,-1)])]),j.value&&K.value?(v(),i("button",{key:1,type:"button",onClick:oe,tabindex:"0",class:"control-btn player-control-btn","aria-label":`Next episode: ${K.value.Name}`,title:`Next: ${K.value.Name}`},[...t[22]||(t[22]=[o("i",{class:"fas fa-step-forward"},null,-1)])],8,Bt)):c("",!0)])])],2)]))}}),[["__scopeId","data-v-67ed9847"]]);export{q as C,fa as G,Oe as H,he as L,va as M,wa as T,Gt as V,se as _,Ca as a,Ba as b,ra as c,Le as d};
